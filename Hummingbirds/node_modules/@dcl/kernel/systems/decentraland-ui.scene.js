!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(1),e),o(n(4),e),o(n(9),e),o(n(10),e),o(n(14),e),o(n(15),e),o(n(16),e),o(n(11),e),o(n(17),e),o(n(18),e),o(n(6),e),o(n(19),e),o(n(20),e),o(n(12),e),o(n(5),e),o(n(3),e),o(n(21),e),o(n(7),e),o(n(2),e),o(n(8),e),o(n(0),e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RAD2DEG=e.DEG2RAD=e.Epsilon=e.ToLinearSpace=e.ToGammaSpace=e.Space=e.Orientation=void 0,function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(e.Orientation||(e.Orientation={})),function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(e.Space||(e.Space={})),e.ToGammaSpace=1/2.2,e.ToLinearSpace=2.2,e.Epsilon=1e-6,e.DEG2RAD=Math.PI/180,e.RAD2DEG=360/(2*Math.PI)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;const i=n(4),o=n(1),r=n(5),s=n(3);class a{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}get isNonUniform(){const t=Math.abs(this.x),e=Math.abs(this.y);if(t!==e)return!0;const n=Math.abs(this.z);return t!==n||e!==n}static Add(t,e){return new a(t.x,t.y,t.z).addInPlace(e)}static GetClipFactor(t,e,n,i){const o=a.Dot(t,n)-i;return o/(o-(a.Dot(e,n)-i))}static GetAngleBetweenVectors(t,e,n){const o=t.normalizeToRef(i.MathTmp.Vector3[1]),r=e.normalizeToRef(i.MathTmp.Vector3[2]),s=a.Dot(o,r),c=i.MathTmp.Vector3[3];return a.CrossToRef(o,r,c),a.Dot(c,n)>0?Math.acos(s):-Math.acos(s)}static FromArray(t,e=0){return new a(t[e],t[e+1],t[e+2])}static FromFloatArray(t,e){return a.FromArray(t,e)}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1],n.z=t[e+2]}static FromFloatArrayToRef(t,e,n){return a.FromArrayToRef(t,e,n)}static FromFloatsToRef(t,e,n,i){i.copyFromFloats(t,e,n)}static Zero(){return new a(0,0,0)}static One(){return new a(1,1,1)}static Up(){return new a(0,1,0)}static Down(){return new a(0,-1,0)}static Forward(){return new a(0,0,1)}static Backward(){return new a(0,0,-1)}static Right(){return new a(1,0,0)}static Left(){return new a(-1,0,0)}static TransformCoordinates(t,e){const n=a.Zero();return a.TransformCoordinatesToRef(t,e,n),n}static TransformCoordinatesToRef(t,e,n){return a.TransformCoordinatesFromFloatsToRef(t.x,t.y,t.z,e,n)}static TransformCoordinatesFromFloatsToRef(t,e,n,i,o){const r=i.m,s=t*r[0]+e*r[4]+n*r[8]+r[12],a=t*r[1]+e*r[5]+n*r[9]+r[13],c=t*r[2]+e*r[6]+n*r[10]+r[14],l=1/(t*r[3]+e*r[7]+n*r[11]+r[15]);o.x=s*l,o.y=a*l,o.z=c*l}static TransformNormal(t,e){const n=a.Zero();return a.TransformNormalToRef(t,e,n),n}static TransformNormalToRef(t,e,n){this.TransformNormalFromFloatsToRef(t.x,t.y,t.z,e,n)}static TransformNormalFromFloatsToRef(t,e,n,i,o){const r=i.m;o.x=t*r[0]+e*r[4]+n*r[8],o.y=t*r[1]+e*r[5]+n*r[9],o.z=t*r[2]+e*r[6]+n*r[10]}static CatmullRom(t,e,n,i,o){const r=o*o,s=o*r,c=.5*(2*e.x+(-t.x+n.x)*o+(2*t.x-5*e.x+4*n.x-i.x)*r+(-t.x+3*e.x-3*n.x+i.x)*s),l=.5*(2*e.y+(-t.y+n.y)*o+(2*t.y-5*e.y+4*n.y-i.y)*r+(-t.y+3*e.y-3*n.y+i.y)*s),p=.5*(2*e.z+(-t.z+n.z)*o+(2*t.z-5*e.z+4*n.z-i.z)*r+(-t.z+3*e.z-3*n.z+i.z)*s);return new a(c,l,p)}static Clamp(t,e,n){const i=new a;return a.ClampToRef(t,e,n,i),i}static ClampToRef(t,e,n,i){let o=t.x;o=o>n.x?n.x:o,o=o<e.x?e.x:o;let r=t.y;r=r>n.y?n.y:r,r=r<e.y?e.y:r;let s=t.z;s=s>n.z?n.z:s,s=s<e.z?e.z:s,i.copyFromFloats(o,r,s)}static Hermite(t,e,n,i,o){const r=o*o,s=o*r,c=2*s-3*r+1,l=-2*s+3*r,p=s-2*r+o,u=s-r,h=t.x*c+n.x*l+e.x*p+i.x*u,d=t.y*c+n.y*l+e.y*p+i.y*u,y=t.z*c+n.z*l+e.z*p+i.z*u;return new a(h,d,y)}static Lerp(t,e,n){const i=new a(0,0,0);return a.LerpToRef(t,e,n,i),i}static LerpToRef(t,e,n,i){i.x=t.x+(e.x-t.x)*n,i.y=t.y+(e.y-t.y)*n,i.z=t.z+(e.z-t.z)*n}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e){const n=a.Zero();return a.CrossToRef(t,e,n),n}static CrossToRef(t,e,n){const i=t.y*e.z-t.z*e.y,o=t.z*e.x-t.x*e.z,r=t.x*e.y-t.y*e.x;n.copyFromFloats(i,o,r)}static Normalize(t){const e=a.Zero();return a.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){t.normalizeToRef(e)}static Minimize(t,e){const n=new a(t.x,t.y,t.z);return n.minimizeInPlace(e),n}static Maximize(t,e){const n=new a(t.x,t.y,t.z);return n.maximizeInPlace(e),n}static Distance(t,e){return Math.sqrt(a.DistanceSquared(t,e))}static DistanceSquared(t,e){const n=t.x-e.x,i=t.y-e.y,o=t.z-e.z;return n*n+i*i+o*o}static Center(t,e){const n=a.Add(t,e);return n.scaleInPlace(.5),n}static RotationFromAxis(t,e,n){const i=a.Zero();return a.RotationFromAxisToRef(t,e,n,i),i}static RotationFromAxisToRef(t,e,n,o){const s=i.MathTmp.Quaternion[0];r.Quaternion.RotationQuaternionFromAxisToRef(t,e,n,s),o.copyFrom(s.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0),t}asArray(){const t=[];return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,this}toQuaternion(){return r.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(t){return this.addInPlaceFromFloats(t.x,t.y,t.z)}addInPlaceFromFloats(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this}add(t){return new a(this.x+t.x,this.y+t.y,this.z+t.z)}addToRef(t,e){return e.copyFromFloats(this.x+t.x,this.y+t.y,this.z+t.z)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subtract(t){return new a(this.x-t.x,this.y-t.y,this.z-t.z)}subtractToRef(t,e){return this.subtractFromFloatsToRef(t.x,t.y,t.z,e)}subtractFromFloats(t,e,n){return new a(this.x-t,this.y-e,this.z-n)}subtractFromFloatsToRef(t,e,n,i){return i.copyFromFloats(this.x-t,this.y-e,this.z-n)}applyMatrix4(t){this.applyMatrix4ToRef(t,this)}applyMatrix4ToRef(t,e){const{x:n,y:i,z:o}=this,{m:r}=t,s=1/(r[3]*n+r[7]*i+r[11]*o+r[15]);return e.x=(r[0]*n+r[4]*i+r[8]*o+r[12])*s,e.y=(r[1]*n+r[5]*i+r[9]*o+r[13])*s,e.z=(r[2]*n+r[6]*i+r[10]*o+r[14])*s,e}rotate(t){return this.rotateToRef(t,this)}rotateToRef(t,e){const{x:n,y:i,z:o}=this,{x:r,y:s,z:a,w:c}=t,l=c*n+s*o-a*i,p=c*i+a*n-r*o,u=c*o+r*i-s*n,h=-r*n-s*i-a*o;return e.x=l*c+h*-r+p*-a-u*-s,e.y=p*c+h*-s+u*-r-l*-a,e.z=u*c+h*-a+l*-s-p*-r,e}negate(){return new a(-this.x,-this.y,-this.z)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this}scale(t){return new a(this.x*t,this.y*t,this.z*t)}scaleToRef(t,e){return e.copyFromFloats(this.x*t,this.y*t,this.z*t)}scaleAndAddToRef(t,e){return e.addInPlaceFromFloats(this.x*t,this.y*t,this.z*t)}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z}equalsWithEpsilon(t,e=o.Epsilon){return t&&s.Scalar.WithinEpsilon(this.x,t.x,e)&&s.Scalar.WithinEpsilon(this.y,t.y,e)&&s.Scalar.WithinEpsilon(this.z,t.z,e)}equalsToFloats(t,e,n){return this.x===t&&this.y===e&&this.z===n}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiply(t){return this.multiplyByFloats(t.x,t.y,t.z)}multiplyToRef(t,e){return e.copyFromFloats(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyByFloats(t,e,n){return new a(this.x*t,this.y*e,this.z*n)}divide(t){return new a(this.x/t.x,this.y/t.y,this.z/t.z)}divideToRef(t,e){return e.copyFromFloats(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return this.minimizeInPlaceFromFloats(t.x,t.y,t.z)}maximizeInPlace(t){return this.maximizeInPlaceFromFloats(t.x,t.y,t.z)}minimizeInPlaceFromFloats(t,e,n){return t<this.x&&(this.x=t),e<this.y&&(this.y=e),n<this.z&&(this.z=n),this}maximizeInPlaceFromFloats(t,e,n){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),n>this.z&&(this.z=n),this}floor(){return new a(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new a(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(t){return 0===t||1===t?this:this.scaleInPlace(1/t)}normalizeToNew(){const t=new a(0,0,0);return this.normalizeToRef(t),t}normalizeToRef(t){const e=this.length();return 0===e||1===e?t.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/e,t)}clone(){return new a(this.x,this.y,this.z)}copyFrom(t){return this.copyFromFloats(t.x,t.y,t.z)}copyFromFloats(t,e,n){return this.x=t,this.y=e,this.z=n,this}set(t,e,n){return this.copyFromFloats(t,e,n)}setAll(t){return this.x=this.y=this.z=t,this}}e.Vector3=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Scalar=void 0;class i{static WithinEpsilon(t,e,n=1401298e-51){const i=t-e;return-n<=i&&i<=n}static ToHex(t){const e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()}static Sign(t){const e=+t;return 0===e||isNaN(e)?e:e>0?1:-1}static Clamp(t,e=0,n=1){return Math.min(n,Math.max(e,t))}static Log2(t){return Math.log(t)*Math.LOG2E}static Repeat(t,e){return t-Math.floor(t/e)*e}static Normalize(t,e,n){return(t-e)/(n-e)}static Denormalize(t,e,n){return t*(n-e)+e}static DeltaAngle(t,e){let n=i.Repeat(e-t,360);return n>180&&(n-=360),n}static PingPong(t,e){const n=i.Repeat(t,2*e);return e-Math.abs(n-e)}static SmoothStep(t,e,n){let o=i.Clamp(n);return o=-2*o*o*o+3*o*o,e*o+t*(1-o)}static MoveTowards(t,e,n){let o=0;return o=Math.abs(e-t)<=n?e:t+i.Sign(e-t)*n,o}static MoveTowardsAngle(t,e,n){const o=i.DeltaAngle(t,e);let r=0;return r=-n<o&&o<n?e:i.MoveTowards(t,t+o,n),r}static Lerp(t,e,n){return t+(e-t)*n}static LerpAngle(t,e,n){let o=i.Repeat(e-t,360);return o>180&&(o-=360),t+o*i.Clamp(n)}static InverseLerp(t,e,n){let o=0;return o=t!==e?i.Clamp((n-t)/(e-t)):0,o}static Hermite(t,e,n,i,o){const r=o*o,s=o*r;return t*(2*s-3*r+1)+n*(-2*s+3*r)+e*(s-2*r+o)+i*(s-r)}static RandomRange(t,e){return t===e?t:Math.random()*(e-t)+t}static RangeToPercent(t,e,n){return(t-e)/(n-e)}static PercentToRange(t,e,n){return(n-e)*t+e}static NormalizeRadians(t){return t-i.TwoPi*Math.floor((t+Math.PI)/i.TwoPi)}}e.Scalar=i,i.TwoPi=2*Math.PI},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathTmp=void 0;const i=n(13),o=n(2),r=n(5),s=n(6);e.MathTmp={Vector3:(0,i.buildArray)(6,o.Vector3.Zero),Matrix:(0,i.buildArray)(2,s.Matrix.Identity),Quaternion:(0,i.buildArray)(3,r.Quaternion.Zero),staticUp:o.Vector3.Up(),tmpMatrix:s.Matrix.Zero()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quaternion=void 0;const i=n(6),o=n(2),r=n(4),s=n(1),a=n(3);class c{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}static FromRotationMatrix(t){const e=new c;return c.FromRotationMatrixToRef(t,e),e}static FromRotationMatrixToRef(t,e){const n=t.m,i=n[0],o=n[4],r=n[8],s=n[1],a=n[5],c=n[9],l=n[2],p=n[6],u=n[10],h=i+a+u;let d;h>0?(d=.5/Math.sqrt(h+1),e.w=.25/d,e.x=(p-c)*d,e.y=(r-l)*d,e.z=(s-o)*d):i>a&&i>u?(d=2*Math.sqrt(1+i-a-u),e.w=(p-c)/d,e.x=.25*d,e.y=(o+s)/d,e.z=(r+l)/d):a>u?(d=2*Math.sqrt(1+a-i-u),e.w=(r-l)/d,e.x=(o+s)/d,e.y=.25*d,e.z=(c+p)/d):(d=2*Math.sqrt(1+u-i-a),e.w=(s-o)/d,e.x=(r+l)/d,e.y=(c+p)/d,e.z=.25*d)}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static AreClose(t,e){return c.Dot(t,e)>=0}static Zero(){return new c(0,0,0,0)}static Inverse(t){return new c(-t.x,-t.y,-t.z,t.w)}static IsIdentity(t){return t&&0===t.x&&0===t.y&&0===t.z&&1===t.w}static RotationAxis(t,e){const n=e*s.DEG2RAD;return c.RotationAxisToRef(t,n,new c)}static RotationAxisToRef(t,e,n){const i=e*s.DEG2RAD,o=Math.sin(i/2);return t.normalize(),n.w=Math.cos(i/2),n.x=t.x*o,n.y=t.y*o,n.z=t.z*o,n}static FromArray(t,e=0){return new c(t[e],t[e+1],t[e+2],t[e+3])}static FromEulerAnglesRef(t,e,n,i){return c.RotationYawPitchRollToRef(e*s.DEG2RAD,t*s.DEG2RAD,n*s.DEG2RAD,i)}static RotationYawPitchRoll(t,e,n){const i=new c;return c.RotationYawPitchRollToRef(t,e,n,i),i}static RotationYawPitchRollToRef(t,e,n,i){const o=.5*e,r=.5*t,s=.5*n,a=Math.cos(o),c=Math.cos(r),l=Math.cos(s),p=Math.sin(o),u=Math.sin(r),h=Math.sin(s);i.x=c*p*l+u*a*h,i.y=u*a*l-c*p*h,i.z=c*a*h-u*p*l,i.w=c*a*l+u*p*h}static RotationAlphaBetaGamma(t,e,n){const i=new c;return c.RotationAlphaBetaGammaToRef(t,e,n,i),i}static RotationAlphaBetaGammaToRef(t,e,n,i){const o=.5*(n+t),r=.5*(n-t),s=.5*e;i.x=Math.cos(r)*Math.sin(s),i.y=Math.sin(r)*Math.sin(s),i.z=Math.sin(o)*Math.cos(s),i.w=Math.cos(o)*Math.cos(s)}static RotationQuaternionFromAxis(t,e,n){const i=new c(0,0,0,0);return c.RotationQuaternionFromAxisToRef(t,e,n,i),i}static RotationQuaternionFromAxisToRef(t,e,n,o){const s=r.MathTmp.Matrix[0];i.Matrix.FromXYZAxesToRef(t.normalize(),e.normalize(),n.normalize(),s),c.FromRotationMatrixToRef(s,o)}static Slerp(t,e,n){const i=c.Identity;return c.SlerpToRef(t,e,n,i),i}static SlerpToRef(t,e,n,i){let o,r,s=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w,a=!1;if(s<0&&(a=!0,s=-s),s>.999999)r=1-n,o=a?-n:n;else{const t=Math.acos(s),e=1/Math.sin(t);r=Math.sin((1-n)*t)*e,o=a?-Math.sin(n*t)*e:Math.sin(n*t)*e}i.x=r*t.x+o*e.x,i.y=r*t.y+o*e.y,i.z=r*t.z+o*e.z,i.w=r*t.w+o*e.w}static Hermite(t,e,n,i,o){const r=o*o,s=o*r,a=2*s-3*r+1,l=-2*s+3*r,p=s-2*r+o,u=s-r,h=t.x*a+n.x*l+e.x*p+i.x*u,d=t.y*a+n.y*l+e.y*p+i.y*u,y=t.z*a+n.z*l+e.z*p+i.z*u,f=t.w*a+n.w*l+e.w*p+i.w*u;return new c(h,d,y,f)}static get Identity(){return new c(0,0,0,1)}static Angle(t,e){const n=c.Dot(t,e);return 2*Math.acos(Math.min(Math.abs(n),1))*s.RAD2DEG}static Euler(t,e,n){return c.RotationYawPitchRoll(e*s.DEG2RAD,t*s.DEG2RAD,n*s.DEG2RAD)}static LookRotation(t,e=r.MathTmp.staticUp){const n=o.Vector3.Normalize(t),i=o.Vector3.Normalize(o.Vector3.Cross(e,n)),s=o.Vector3.Cross(n,i),a=i.x,l=i.y,p=i.z,u=s.x,h=s.y,d=s.z,y=n.x,f=n.y,m=n.z,g=a+h+m,v=new c;if(g>0){let t=Math.sqrt(g+1);return v.w=.5*t,t=.5/t,v.x=(d-f)*t,v.y=(y-p)*t,v.z=(l-u)*t,v}if(a>=h&&a>=m){const t=Math.sqrt(1+a-h-m),e=.5/t;return v.x=.5*t,v.y=(l+u)*e,v.z=(p+y)*e,v.w=(d-f)*e,v}if(h>m){const t=Math.sqrt(1+h-a-m),e=.5/t;return v.x=(u+l)*e,v.y=.5*t,v.z=(f+d)*e,v.w=(y-p)*e,v}const _=Math.sqrt(1+m-a-h),b=.5/_;return v.x=(y+p)*b,v.y=(f+d)*b,v.z=.5*_,v.w=(l-u)*b,v}static RotateTowards(t,e,n){const i=c.Angle(t,e);if(0===i)return e;const o=Math.min(1,n/i);return c.Slerp(t,e,o)}static FromToRotation(t,e,n=r.MathTmp.staticUp){const i=t.normalize(),s=e.normalize(),a=o.Vector3.Cross(i,s),l=Math.sqrt(i.lengthSquared()*s.lengthSquared())+o.Vector3.Dot(i,s);return a.lengthSquared()<1e-4?Math.abs(l)<1e-4?new c(n.x,n.y,n.z,0).normalized:c.Identity:new c(a.x,a.y,a.z,l).normalized}get normalized(){return this.normalize()}setFromToRotation(t,e,n=r.MathTmp.staticUp){const i=c.FromToRotation(t,e,n);this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w}set eulerAngles(t){this.setEuler(t.x,t.y,t.z)}get eulerAngles(){const t=new o.Vector3,e=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,n=this.x*this.w-this.y*this.z;return n>.4995*e?(t.x=Math.PI/2,t.y=2*Math.atan2(this.y,this.x),t.z=0):n<-.4995*e?(t.x=-Math.PI/2,t.y=-2*Math.atan2(this.y,this.x),t.z=0):(t.x=Math.asin(2*(this.w*this.x-this.y*this.z)),t.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),t.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),t.x*=s.RAD2DEG,t.y*=s.RAD2DEG,t.z*=s.RAD2DEG,t.x=a.Scalar.Repeat(t.x,360),t.y=a.Scalar.Repeat(t.y,360),t.z=a.Scalar.Repeat(t.z,360),t}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0),t=397*t^(this.w||0),t}asArray(){return[this.x,this.y,this.z,this.w]}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}clone(){return new c(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}set(t,e,n,i){return this.copyFromFloats(t,e,n,i)}setEuler(t,e,n){return c.RotationYawPitchRollToRef(e*s.DEG2RAD,t*s.DEG2RAD,n*s.DEG2RAD,this),this}add(t){return new c(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return new c(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new c(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}multiply(t){const e=new c(0,0,0,1);return this.multiplyToRef(t,e),e}multiplyToRef(t,e){const n=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,i=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,o=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,r=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return e.copyFromFloats(n,i,o,r),this}multiplyInPlace(t){return this.multiplyToRef(t,this),this}conjugateToRef(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new c(-this.x,-this.y,-this.z,this.w)}normalize(){const t=1/this.length;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}angleAxis(t,e){if(0===e.lengthSquared())return c.Identity;const n=c.Identity;let i=t*s.DEG2RAD;i*=.5;let o=e.normalize();return o=e.scaleInPlace(Math.sin(i)),n.x=o.x,n.y=o.y,n.z=o.z,n.w=Math.cos(i),n.normalize()}toRotationMatrix(t){return i.Matrix.FromQuaternionToRef(this,t),this}fromRotationMatrix(t){return c.FromRotationMatrixToRef(t,this),this}}e.Quaternion=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix=void 0;const i=n(2),o=n(5),r=n(4),s=n(8);class a{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return a._identityReadOnly}static FromArray(t,e=0){const n=new a;return a.FromArrayToRef(t,e,n),n}static FromArrayToRef(t,e,n){for(let i=0;i<16;i++)n._m[i]=t[i+e];n._markAsUpdated()}static FromFloatArrayToRefScaled(t,e,n,i){for(let o=0;o<16;o++)i._m[o]=t[o+e]*n;i._markAsUpdated()}static FromValuesToRef(t,e,n,i,o,r,s,a,c,l,p,u,h,d,y,f,m){const g=m._m;g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=o,g[5]=r,g[6]=s,g[7]=a,g[8]=c,g[9]=l,g[10]=p,g[11]=u,g[12]=h,g[13]=d,g[14]=y,g[15]=f,m._markAsUpdated()}static FromValues(t,e,n,i,o,r,s,c,l,p,u,h,d,y,f,m){const g=new a,v=g._m;return v[0]=t,v[1]=e,v[2]=n,v[3]=i,v[4]=o,v[5]=r,v[6]=s,v[7]=c,v[8]=l,v[9]=p,v[10]=u,v[11]=h,v[12]=d,v[13]=y,v[14]=f,v[15]=m,g._markAsUpdated(),g}static Compose(t,e,n){const i=new a;return a.ComposeToRef(t,e,n,i),i}static ComposeToRef(t,e,n,i){a.ScalingToRef(t.x,t.y,t.z,r.MathTmp.Matrix[1]),e.toRotationMatrix(r.MathTmp.Matrix[0]),r.MathTmp.Matrix[1].multiplyToRef(r.MathTmp.Matrix[0],i),i.setTranslation(n)}static Identity(){const t=a.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t}static IdentityToRef(t){a.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0)}static Zero(){const t=a.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t}static RotationX(t){const e=new a;return a.RotationXToRef(t,e),e}static Invert(t){const e=new a;return t.invertToRef(e),e}static RotationXToRef(t,e){const n=Math.sin(t),i=Math.cos(t);a.FromValuesToRef(1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1,e),e._updateIdentityStatus(1===i&&0===n)}static RotationY(t){const e=new a;return a.RotationYToRef(t,e),e}static RotationYToRef(t,e){const n=Math.sin(t),i=Math.cos(t);a.FromValuesToRef(i,0,-n,0,0,1,0,0,n,0,i,0,0,0,0,1,e),e._updateIdentityStatus(1===i&&0===n)}static RotationZ(t){const e=new a;return a.RotationZToRef(t,e),e}static RotationZToRef(t,e){const n=Math.sin(t),i=Math.cos(t);a.FromValuesToRef(i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(1===i&&0===n)}static RotationAxis(t,e){const n=new a;return a.RotationAxisToRef(t,e,n),n}static RotationAxisToRef(t,e,n){const i=Math.sin(-e),o=Math.cos(-e),r=1-o;t.normalize();const s=n._m;s[0]=t.x*t.x*r+o,s[1]=t.x*t.y*r-t.z*i,s[2]=t.x*t.z*r+t.y*i,s[3]=0,s[4]=t.y*t.x*r+t.z*i,s[5]=t.y*t.y*r+o,s[6]=t.y*t.z*r-t.x*i,s[7]=0,s[8]=t.z*t.x*r-t.y*i,s[9]=t.z*t.y*r+t.x*i,s[10]=t.z*t.z*r+o,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,n._markAsUpdated()}static RotationYawPitchRoll(t,e,n){const i=new a;return a.RotationYawPitchRollToRef(t,e,n,i),i}static RotationYawPitchRollToRef(t,e,n,i){o.Quaternion.RotationYawPitchRollToRef(t,e,n,r.MathTmp.Quaternion[0]),r.MathTmp.Quaternion[0].toRotationMatrix(i)}static Scaling(t,e,n){const i=new a;return a.ScalingToRef(t,e,n,i),i}static ScalingToRef(t,e,n,i){a.FromValuesToRef(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1,i),i._updateIdentityStatus(1===t&&1===e&&1===n)}static Translation(t,e,n){const i=new a;return a.TranslationToRef(t,e,n,i),i}static TranslationToRef(t,e,n,i){a.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1,i),i._updateIdentityStatus(0===t&&0===e&&0===n)}static Lerp(t,e,n){const i=new a;return a.LerpToRef(t,e,n,i),i}static LerpToRef(t,e,n,i){for(let o=0;o<16;o++)i._m[o]=t._m[o]*(1-n)+e._m[o]*n;i._markAsUpdated()}static DecomposeLerp(t,e,n){const i=new a;return a.DecomposeLerpToRef(t,e,n,i),i}static DecomposeLerpToRef(t,e,n,s){const c=r.MathTmp.Vector3[0],l=r.MathTmp.Quaternion[0],p=r.MathTmp.Vector3[1];t.decompose(c,l,p);const u=r.MathTmp.Vector3[2],h=r.MathTmp.Quaternion[1],d=r.MathTmp.Vector3[3];e.decompose(u,h,d);const y=r.MathTmp.Vector3[4];i.Vector3.LerpToRef(c,u,n,y);const f=r.MathTmp.Quaternion[2];o.Quaternion.SlerpToRef(l,h,n,f);const m=r.MathTmp.Vector3[5];i.Vector3.LerpToRef(p,d,n,m),a.ComposeToRef(y,f,m,s)}static LookAtLH(t,e,n){const i=new a;return a.LookAtLHToRef(t,e,n,i),i}static LookAtLHToRef(t,e,n,o){const s=r.MathTmp.Vector3[0],c=r.MathTmp.Vector3[1],l=r.MathTmp.Vector3[2];e.subtractToRef(t,l),l.normalize(),i.Vector3.CrossToRef(n,l,s);const p=s.lengthSquared();0===p?s.x=1:s.normalizeFromLength(Math.sqrt(p)),i.Vector3.CrossToRef(l,s,c),c.normalize();const u=-i.Vector3.Dot(s,t),h=-i.Vector3.Dot(c,t),d=-i.Vector3.Dot(l,t);a.FromValuesToRef(s.x,c.x,l.x,0,s.y,c.y,l.y,0,s.z,c.z,l.z,0,u,h,d,1,o)}static LookAtRH(t,e,n){const i=new a;return a.LookAtRHToRef(t,e,n,i),i}static LookAtRHToRef(t,e,n,o){const s=r.MathTmp.Vector3[0],c=r.MathTmp.Vector3[1],l=r.MathTmp.Vector3[2];t.subtractToRef(e,l),l.normalize(),i.Vector3.CrossToRef(n,l,s);const p=s.lengthSquared();0===p?s.x=1:s.normalizeFromLength(Math.sqrt(p)),i.Vector3.CrossToRef(l,s,c),c.normalize();const u=-i.Vector3.Dot(s,t),h=-i.Vector3.Dot(c,t),d=-i.Vector3.Dot(l,t);a.FromValuesToRef(s.x,c.x,l.x,0,s.y,c.y,l.y,0,s.z,c.z,l.z,0,u,h,d,1,o)}static OrthoLH(t,e,n,i){const o=new a;return a.OrthoLHToRef(t,e,n,i,o),o}static OrthoLHToRef(t,e,n,i,o){const r=2/t,s=2/e,c=2/(i-n),l=-(i+n)/(i-n);a.FromValuesToRef(r,0,0,0,0,s,0,0,0,0,c,0,0,0,l,1,o),o._updateIdentityStatus(1===r&&1===s&&1===c&&0===l)}static OrthoOffCenterLH(t,e,n,i,o,r){const s=new a;return a.OrthoOffCenterLHToRef(t,e,n,i,o,r,s),s}static OrthoOffCenterLHToRef(t,e,n,i,o,r,s){const c=2/(e-t),l=2/(i-n),p=2/(r-o),u=-(r+o)/(r-o),h=(t+e)/(t-e),d=(i+n)/(n-i);a.FromValuesToRef(c,0,0,0,0,l,0,0,0,0,p,0,h,d,u,1,s),s._markAsUpdated()}static OrthoOffCenterRH(t,e,n,i,o,r){const s=new a;return a.OrthoOffCenterRHToRef(t,e,n,i,o,r,s),s}static OrthoOffCenterRHToRef(t,e,n,i,o,r,s){a.OrthoOffCenterLHToRef(t,e,n,i,o,r,s),s._m[10]*=-1}static PerspectiveLH(t,e,n,i){const o=new a,r=2*n/t,s=2*n/e,c=(i+n)/(i-n),l=-2*i*n/(i-n);return a.FromValuesToRef(r,0,0,0,0,s,0,0,0,0,c,1,0,0,l,0,o),o._updateIdentityStatus(!1),o}static PerspectiveFovLH(t,e,n,i){const o=new a;return a.PerspectiveFovLHToRef(t,e,n,i,o),o}static PerspectiveFovLHToRef(t,e,n,i,o,r=!0){const s=n,c=i,l=1/Math.tan(.5*t),p=r?l/e:l,u=r?l:l*e,h=(c+s)/(c-s),d=-2*c*s/(c-s);a.FromValuesToRef(p,0,0,0,0,u,0,0,0,0,h,1,0,0,d,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovRH(t,e,n,i){const o=new a;return a.PerspectiveFovRHToRef(t,e,n,i,o),o}static PerspectiveFovRHToRef(t,e,n,i,o,r=!0){const s=n,c=i,l=1/Math.tan(.5*t),p=r?l/e:l,u=r?l:l*e,h=-(c+s)/(c-s),d=-2*c*s/(c-s);a.FromValuesToRef(p,0,0,0,0,u,0,0,0,0,h,-1,0,0,d,0,o),o._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(t,e,n,i,o=!1){const r=o?-1:1,s=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),l=Math.tan(t.rightDegrees*Math.PI/180),p=2/(c+l),u=2/(s+a),h=i._m;h[0]=p,h[1]=h[2]=h[3]=h[4]=0,h[5]=u,h[6]=h[7]=0,h[8]=(c-l)*p*.5,h[9]=-(s-a)*u*.5,h[10]=-n/(e-n),h[11]=1*r,h[12]=h[13]=h[15]=0,h[14]=-2*n*e/(n-e),i._markAsUpdated()}static GetAsMatrix2x2(t){return[t._m[0],t._m[1],t._m[4],t._m[5]]}static GetAsMatrix3x3(t){return[t._m[0],t._m[1],t._m[2],t._m[4],t._m[5],t._m[6],t._m[8],t._m[9],t._m[10]]}static Transpose(t){const e=new a;return a.TransposeToRef(t,e),e}static TransposeToRef(t,e){const n=e._m,i=t._m;n[0]=i[0],n[1]=i[4],n[2]=i[8],n[3]=i[12],n[4]=i[1],n[5]=i[5],n[6]=i[9],n[7]=i[13],n[8]=i[2],n[9]=i[6],n[10]=i[10],n[11]=i[14],n[12]=i[3],n[13]=i[7],n[14]=i[11],n[15]=i[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)}static Reflection(t){const e=new a;return a.ReflectionToRef(t,e),e}static ReflectionToRef(t,e){t.normalize();const n=t.normal.x,i=t.normal.y,o=t.normal.z,r=-2*n,s=-2*i,c=-2*o;a.FromValuesToRef(r*n+1,s*n,c*n,0,r*i,s*i+1,c*i,0,r*o,s*o,c*o+1,0,r*t.d,s*t.d,c*t.d,1,e)}static FromXYZAxesToRef(t,e,n,i){a.FromValuesToRef(t.x,t.y,t.z,0,e.x,e.y,e.z,0,n.x,n.y,n.z,0,0,0,0,1,i)}static FromQuaternionToRef(t,e){const n=t.x*t.x,i=t.y*t.y,o=t.z*t.z,r=t.x*t.y,s=t.z*t.w,a=t.z*t.x,c=t.y*t.w,l=t.y*t.z,p=t.x*t.w;e._m[0]=1-2*(i+o),e._m[1]=2*(r+s),e._m[2]=2*(a-c),e._m[3]=0,e._m[4]=2*(r-s),e._m[5]=1-2*(o+n),e._m[6]=2*(l+p),e._m[7]=0,e._m[8]=2*(a+c),e._m[9]=2*(l-p),e._m[10]=1-2*(i+n),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()}_markAsUpdated(){this.updateFlag=a._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const t=this._m,e=t[0],n=t[1],i=t[2],o=t[3],r=t[4],s=t[5],a=t[6],c=t[7],l=t[8],p=t[9],u=t[10],h=t[11],d=t[12],y=t[13],f=t[14],m=t[15],g=u*m-f*h,v=p*m-y*h,_=p*f-y*u,b=l*m-d*h,w=l*f-u*d,x=l*y-d*p;return e*+(s*g-a*v+c*_)+n*-(r*g-a*b+c*w)+i*+(r*v-s*b+c*x)+o*-(r*_-s*w+a*x)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return a.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(t){const e=new a;return this.addToRef(t,e),e}addToRef(t,e){for(let n=0;n<16;n++)e._m[n]=this._m[n]+t._m[n];return e._markAsUpdated(),this}addToSelf(t){for(let e=0;e<16;e++)this._m[e]+=t._m[e];return this._markAsUpdated(),this}invertToRef(t){if(!0===this._isIdentity)return a.IdentityToRef(t),this;const e=this._m,n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],c=e[5],l=e[6],p=e[7],u=e[8],h=e[9],d=e[10],y=e[11],f=e[12],m=e[13],g=e[14],v=e[15],_=d*v-g*y,b=h*v-m*y,w=h*g-m*d,x=u*v-f*y,T=u*g-d*f,R=u*m-f*h,A=+(c*_-l*b+p*w),E=-(s*_-l*x+p*T),S=+(s*b-c*x+p*R),O=-(s*w-c*T+l*R),C=n*A+i*E+o*S+r*O;if(0===C)return t.copyFrom(this),this;const z=1/C,P=l*v-g*p,M=c*v-m*p,I=c*g-m*l,N=s*v-f*p,F=s*g-f*l,L=s*m-f*c,D=l*y-d*p,j=c*y-h*p,B=c*d-h*l,H=s*y-u*p,V=s*d-u*l,U=s*h-u*c,k=-(i*_-o*b+r*w),G=+(n*_-o*x+r*T),q=-(n*b-i*x+r*R),W=+(n*w-i*T+o*R),Y=+(i*P-o*M+r*I),X=-(n*P-o*N+r*F),Q=+(n*M-i*N+r*L),Z=-(n*I-i*F+o*L),J=-(i*D-o*j+r*B),K=+(n*D-o*H+r*V),$=-(n*j-i*H+r*U),tt=+(n*B-i*V+o*U);return a.FromValuesToRef(A*z,k*z,Y*z,J*z,E*z,G*z,X*z,K*z,S*z,q*z,Q*z,$*z,O*z,W*z,Z*z,tt*z,t),this}addAtIndex(t,e){return this._m[t]+=e,this._markAsUpdated(),this}multiplyAtIndex(t,e){return this._m[t]*=e,this._markAsUpdated(),this}setTranslationFromFloats(t,e,n){return this._m[12]=t,this._m[13]=e,this._m[14]=n,this._markAsUpdated(),this}setTranslation(t){return this.setTranslationFromFloats(t.x,t.y,t.z)}getTranslation(){return new i.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this}removeRotationAndScaling(){const t=this.m;return a.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]),this}multiply(t){const e=new a;return this.multiplyToRef(t,e),e}copyFrom(t){t.copyToArray(this._m);const e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this}copyToArray(t,e=0){for(let n=0;n<16;n++)t[e+n]=this._m[n];return this}multiplyToRef(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)}multiplyToArray(t,e,n){const i=this._m,o=t.m,r=i[0],s=i[1],a=i[2],c=i[3],l=i[4],p=i[5],u=i[6],h=i[7],d=i[8],y=i[9],f=i[10],m=i[11],g=i[12],v=i[13],_=i[14],b=i[15],w=o[0],x=o[1],T=o[2],R=o[3],A=o[4],E=o[5],S=o[6],O=o[7],C=o[8],z=o[9],P=o[10],M=o[11],I=o[12],N=o[13],F=o[14],L=o[15];return e[n]=r*w+s*A+a*C+c*I,e[n+1]=r*x+s*E+a*z+c*N,e[n+2]=r*T+s*S+a*P+c*F,e[n+3]=r*R+s*O+a*M+c*L,e[n+4]=l*w+p*A+u*C+h*I,e[n+5]=l*x+p*E+u*z+h*N,e[n+6]=l*T+p*S+u*P+h*F,e[n+7]=l*R+p*O+u*M+h*L,e[n+8]=d*w+y*A+f*C+m*I,e[n+9]=d*x+y*E+f*z+m*N,e[n+10]=d*T+y*S+f*P+m*F,e[n+11]=d*R+y*O+f*M+m*L,e[n+12]=g*w+v*A+_*C+b*I,e[n+13]=g*x+v*E+_*z+b*N,e[n+14]=g*T+v*S+_*P+b*F,e[n+15]=g*R+v*O+_*M+b*L,this}equals(t){const e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;const n=this.m,i=e.m;return n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]&&n[3]===i[3]&&n[4]===i[4]&&n[5]===i[5]&&n[6]===i[6]&&n[7]===i[7]&&n[8]===i[8]&&n[9]===i[9]&&n[10]===i[10]&&n[11]===i[11]&&n[12]===i[12]&&n[13]===i[13]&&n[14]===i[14]&&n[15]===i[15]}clone(){const t=new a;return t.copyFrom(this),t}getClassName(){return"Matrix"}getHashCode(){let t=this._m[0]||0;for(let e=1;e<16;e++)t=397*t^(this._m[e]||0);return t}decompose(t,e,n){if(this._isIdentity)return n&&n.setAll(0),t&&t.setAll(1),e&&e.copyFromFloats(0,0,0,1),!0;const i=this._m;n&&n.copyFromFloats(i[12],i[13],i[14]);const s=t||r.MathTmp.Vector3[0];if(s.x=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),s.y=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),s.z=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),this.determinant()<=0&&(s.y*=-1),0===s.x||0===s.y||0===s.z)return e&&e.copyFromFloats(0,0,0,1),!1;if(e){const t=1/s.x,n=1/s.y,c=1/s.z;a.FromValuesToRef(i[0]*t,i[1]*t,i[2]*t,0,i[4]*n,i[5]*n,i[6]*n,0,i[8]*c,i[9]*c,i[10]*c,0,0,0,0,1,r.MathTmp.Matrix[0]),o.Quaternion.FromRotationMatrixToRef(r.MathTmp.Matrix[0],e)}return!0}getRow(t){if(t<0||t>3)return null;const e=4*t;return new s.Vector4(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])}setRow(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)}transpose(){return a.Transpose(this)}transposeToRef(t){return a.TransposeToRef(this,t),this}setRowFromFloats(t,e,n,i,o){if(t<0||t>3)return this;const r=4*t;return this._m[r+0]=e,this._m[r+1]=n,this._m[r+2]=i,this._m[r+3]=o,this._markAsUpdated(),this}scale(t){const e=new a;return this.scaleToRef(t,e),e}scaleToRef(t,e){for(let n=0;n<16;n++)e._m[n]=this._m[n]*t;return e._markAsUpdated(),this}scaleAndAddToRef(t,e){for(let n=0;n<16;n++)e._m[n]+=this._m[n]*t;return e._markAsUpdated(),this}toNormalMatrix(t){const e=r.MathTmp.Matrix[0];this.invertToRef(e),e.transposeToRef(t);const n=t._m;a.FromValuesToRef(n[0],n[1],n[2],0,n[4],n[5],n[6],0,n[8],n[9],n[10],0,0,0,0,1,t)}getRotationMatrix(){const t=new a;return this.getRotationMatrixToRef(t),t}getRotationMatrixToRef(t){const e=r.MathTmp.Vector3[0];if(!this.decompose(e))return a.IdentityToRef(t),this;const n=this._m,i=1/e.x,o=1/e.y,s=1/e.z;return a.FromValuesToRef(n[0]*i,n[1]*i,n[2]*i,0,n[4]*o,n[5]*o,n[6]*o,0,n[8]*s,n[9]*s,n[10]*s,0,0,0,0,1,t),this}toggleModelMatrixHandInPlace(){const t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){const t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(t,e=!1,n=!1,i=!0){this.updateFlag=a._updateFlagSeed++,this._isIdentity=t,this._isIdentity3x2=t||n,this._isIdentityDirty=!this._isIdentity&&e,this._isIdentity3x2Dirty=!this._isIdentity3x2&&i}}e.Matrix=a,a._updateFlagSeed=0,a._identityReadOnly=a.Identity()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;const i=n(1),o=n(3);class r{constructor(t=0,e=0){this.x=t,this.y=e}static Zero(){return new r(0,0)}static One(){return new r(1,1)}static Add(t,e){return new r(t.x,t.y).addInPlace(e)}static FromArray(t,e=0){return new r(t[e],t[e+1])}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1]}static CatmullRom(t,e,n,i,o){const s=o*o,a=o*s,c=.5*(2*e.x+(-t.x+n.x)*o+(2*t.x-5*e.x+4*n.x-i.x)*s+(-t.x+3*e.x-3*n.x+i.x)*a),l=.5*(2*e.y+(-t.y+n.y)*o+(2*t.y-5*e.y+4*n.y-i.y)*s+(-t.y+3*e.y-3*n.y+i.y)*a);return new r(c,l)}static Clamp(t,e,n){let i=t.x;i=i>n.x?n.x:i,i=i<e.x?e.x:i;let o=t.y;return o=o>n.y?n.y:o,o=o<e.y?e.y:o,new r(i,o)}static Hermite(t,e,n,i,o){const s=o*o,a=o*s,c=2*a-3*s+1,l=-2*a+3*s,p=a-2*s+o,u=a-s,h=t.x*c+n.x*l+e.x*p+i.x*u,d=t.y*c+n.y*l+e.y*p+i.y*u;return new r(h,d)}static Lerp(t,e,n){const i=t.x+(e.x-t.x)*n,o=t.y+(e.y-t.y)*n;return new r(i,o)}static Dot(t,e){return t.x*e.x+t.y*e.y}static Normalize(t){const e=new r(t.x,t.y);return e.normalize(),e}static Minimize(t,e){const n=t.x<e.x?t.x:e.x,i=t.y<e.y?t.y:e.y;return new r(n,i)}static Maximize(t,e){const n=t.x>e.x?t.x:e.x,i=t.y>e.y?t.y:e.y;return new r(n,i)}static Transform(t,e){const n=r.Zero();return r.TransformToRef(t,e,n),n}static TransformToRef(t,e,n){const i=e.m,o=t.x*i[0]+t.y*i[4]+i[12],r=t.x*i[1]+t.y*i[5]+i[13];n.x=o,n.y=r}static PointInTriangle(t,e,n,i){const o=.5*(-n.y*i.x+e.y*(-n.x+i.x)+e.x*(n.y-i.y)+n.x*i.y),r=o<0?-1:1,s=(e.y*i.x-e.x*i.y+(i.y-e.y)*t.x+(e.x-i.x)*t.y)*r,a=(e.x*n.y-e.y*n.x+(e.y-n.y)*t.x+(n.x-e.x)*t.y)*r;return s>0&&a>0&&s+a<2*o*r}static Distance(t,e){return Math.sqrt(r.DistanceSquared(t,e))}static DistanceSquared(t,e){const n=t.x-e.x,i=t.y-e.y;return n*n+i*i}static Center(t,e){const n=r.Add(t,e);return n.scaleInPlace(.5),n}static DistanceOfPointFromSegment(t,e,n){const i=r.DistanceSquared(e,n);if(0===i)return r.Distance(t,e);const o=n.subtract(e),s=Math.max(0,Math.min(1,r.Dot(t.subtract(e),o)/i)),a=e.add(o.multiplyByFloats(s,s));return r.Distance(t,a)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let t=this.x||0;return t=397*t^(this.y||0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,this}asArray(){const t=new Array;return this.toArray(t,0),t}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,e){return this.x=t,this.y=e,this}set(t,e){return this.copyFromFloats(t,e)}add(t){return new r(this.x+t.x,this.y+t.y)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}addVector3(t){return new r(this.x+t.x,this.y+t.y)}subtract(t){return new r(this.x-t.x,this.y-t.y)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new r(this.x*t.x,this.y*t.y)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this}multiplyByFloats(t,e){return new r(this.x*t,this.y*e)}divide(t){return new r(this.x/t.x,this.y/t.y)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this}divideInPlace(t){return this.divideToRef(t,this)}negate(){return new r(-this.x,-this.y)}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){const e=new r(0,0);return this.scaleToRef(t,e),e}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y}equalsWithEpsilon(t,e=i.Epsilon){return t&&o.Scalar.WithinEpsilon(this.x,t.x,e)&&o.Scalar.WithinEpsilon(this.y,t.y,e)}floor(){return new r(Math.floor(this.x),Math.floor(this.y))}fract(){return new r(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){const t=this.length();if(0===t)return this;const e=1/t;return this.x*=e,this.y*=e,this}clone(){return new r(this.x,this.y)}}e.Vector2=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector4=void 0;const i=n(1),o=n(3),r=n(2);class s{constructor(t,e,n,i){this.x=t,this.y=e,this.z=n,this.w=i}static Add(t,e){return new s(t.x,t.y,t.z,t.w).addInPlace(e)}static FromArray(t,e=0){return new s(t[e],t[e+1],t[e+2],t[e+3])}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1],n.z=t[e+2],n.w=t[e+3]}static FromFloatArrayToRef(t,e,n){s.FromArrayToRef(t,e,n)}static FromFloatsToRef(t,e,n,i,o){o.x=t,o.y=e,o.z=n,o.w=i}static Zero(){return new s(0,0,0,0)}static One(){return new s(1,1,1,1)}static Normalize(t){const e=s.Zero();return s.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){e.copyFrom(t),e.normalize()}static Minimize(t,e){const n=new s(t.x,t.y,t.z,t.w);return n.minimizeInPlace(e),n}static Maximize(t,e){const n=new s(t.x,t.y,t.z,t.w);return n.maximizeInPlace(e),n}static Distance(t,e){return Math.sqrt(s.DistanceSquared(t,e))}static DistanceSquared(t,e){const n=t.x-e.x,i=t.y-e.y,o=t.z-e.z,r=t.w-e.w;return n*n+i*i+o*o+r*r}static Center(t,e){const n=s.Add(t,e);return n.scaleInPlace(.5),n}static TransformNormal(t,e){const n=s.Zero();return s.TransformNormalToRef(t,e,n),n}static TransformNormalToRef(t,e,n){const i=e.m,o=t.x*i[0]+t.y*i[4]+t.z*i[8],r=t.x*i[1]+t.y*i[5]+t.z*i[9],s=t.x*i[2]+t.y*i[6]+t.z*i[10];n.x=o,n.y=r,n.z=s,n.w=t.w}static TransformNormalFromFloatsToRef(t,e,n,i,o,r){const s=o.m;r.x=t*s[0]+e*s[4]+n*s[8],r.y=t*s[1]+e*s[5]+n*s[9],r.z=t*s[2]+e*s[6]+n*s[10],r.w=i}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let t=this.x||0;return t=397*t^(this.y||0),t=397*t^(this.z||0),t=397*t^(this.w||0),t}asArray(){const t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this}addInPlace(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}add(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subtract(t){return new s(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this}subtractFromFloats(t,e,n,i){return new s(this.x-t,this.y-e,this.z-n,this.w-i)}subtractFromFloatsToRef(t,e,n,i,o){return o.x=this.x-t,o.y=this.y-e,o.z=this.z-n,o.w=this.w-i,this}negate(){return new s(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}scale(t){return new s(this.x*t,this.y*t,this.z*t,this.w*t)}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w}equalsWithEpsilon(t,e=i.Epsilon){return t&&o.Scalar.WithinEpsilon(this.x,t.x,e)&&o.Scalar.WithinEpsilon(this.y,t.y,e)&&o.Scalar.WithinEpsilon(this.z,t.z,e)&&o.Scalar.WithinEpsilon(this.w,t.w,e)}equalsToFloats(t,e,n,i){return this.x===t&&this.y===e&&this.z===n&&this.w===i}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiply(t){return new s(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this}multiplyByFloats(t,e,n,i){return new s(this.x*t,this.y*e,this.z*n,this.w*i)}divide(t){return new s(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this}divideInPlace(t){return this.divideToRef(t,this)}minimizeInPlace(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this}maximizeInPlace(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this}floor(){return new s(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new s(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const t=this.length();return 0===t?this:this.scaleInPlace(1/t)}toVector3(){return new r.Vector3(this.x,this.y,this.z)}clone(){return new s(this.x,this.y,this.z,this.w)}copyFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}copyFromFloats(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}set(t,e,n,i){return this.copyFromFloats(t,e,n,i)}setAll(t){return this.x=this.y=this.z=this.w=t,this}}e.Vector4=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Angle=void 0;class i{constructor(t){this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(t,e){const n=e.subtract(t),o=Math.atan2(n.y,n.x);return new i(o)}static FromRadians(t){return new i(t)}static FromDegrees(t){return new i(t*Math.PI/180)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}}e.Angle=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Arc2=void 0;const i=n(9),o=n(7),r=n(1);e.Arc2=class{constructor(t,e,n){this.startPoint=t,this.midPoint=e,this.endPoint=n;const s=Math.pow(e.x,2)+Math.pow(e.y,2),a=(Math.pow(t.x,2)+Math.pow(t.y,2)-s)/2,c=(s-Math.pow(n.x,2)-Math.pow(n.y,2))/2,l=(t.x-e.x)*(e.y-n.y)-(e.x-n.x)*(t.y-e.y);this.centerPoint=new o.Vector2((a*(e.y-n.y)-c*(t.y-e.y))/l,((t.x-e.x)*c-(e.x-n.x)*a)/l),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=i.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);const p=this.startAngle.degrees();let u=i.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),h=i.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-p>180&&(u-=360),u-p<-180&&(u+=360),h-u>180&&(h-=360),h-u<-180&&(h+=360),this.orientation=u-p<0?r.Orientation.CW:r.Orientation.CCW,this.angle=i.Angle.FromDegrees(this.orientation===r.Orientation.CW?p-h:h-p)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Color4=void 0;const i=n(3),o=n(1);class r{constructor(t=0,e=0,n=0,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static FromHexString(t){if("#"!==t.substring(0,1)||9!==t.length)return new r(0,0,0,0);const e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16),o=parseInt(t.substring(7,9),16);return r.FromInts(e,n,i,o)}static Lerp(t,e,n){const i=new r(0,0,0,0);return r.LerpToRef(t,e,n,i),i}static LerpToRef(t,e,n,i){i.r=t.r+(e.r-t.r)*n,i.g=t.g+(e.g-t.g)*n,i.b=t.b+(e.b-t.b)*n,i.a=t.a+(e.a-t.a)*n}static Red(){return new r(1,0,0,1)}static Green(){return new r(0,1,0,1)}static Blue(){return new r(0,0,1,1)}static Black(){return new r(0,0,0,1)}static White(){return new r(1,1,1,1)}static Purple(){return new r(.5,0,.5,1)}static Magenta(){return new r(1,0,1,1)}static Yellow(){return new r(1,1,0,1)}static Gray(){return new r(.5,.5,.5,1)}static Teal(){return new r(0,1,1,1)}static Clear(){return new r(0,0,0,0)}static FromColor3(t,e=1){return new r(t.r,t.g,t.b,e)}static FromArray(t,e=0){return new r(t[e],t[e+1],t[e+2],t[e+3])}static FromInts(t,e,n,i){return new r(t/255,e/255,n/255,i/255)}static CheckColors4(t,e){if(t.length===3*e){const e=[];for(let n=0;n<t.length;n+=3){const i=n/3*4;e[i]=t[n],e[i+1]=t[n+1],e[i+2]=t[n+2],e[i+3]=1}return e}return t}addInPlace(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}asArray(){const t=new Array;return this.toArray(t,0),t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this}add(t){return new r(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new r(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this}scale(t){return new r(this.r*t,this.g*t,this.b*t,this.a*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this}clampToRef(t=0,e=1,n){return n.r=i.Scalar.Clamp(this.r,t,e),n.g=i.Scalar.Clamp(this.g,t,e),n.b=i.Scalar.Clamp(this.b,t,e),n.a=i.Scalar.Clamp(this.a,t,e),this}multiply(t){return new r(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let t=this.r||0;return t=397*t^(this.g||0),t=397*t^(this.b||0),t=397*t^(this.a||0),t}clone(){return new r(this.r,this.g,this.b,this.a)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}copyFromFloats(t,e,n,i){return this.r=t,this.g=e,this.b=n,this.a=i,this}set(t,e,n,i){return this.copyFromFloats(t,e,n,i)}toHexString(){const t=255*this.r|0,e=255*this.g|0,n=255*this.b|0,o=255*this.a|0;return"#"+i.Scalar.ToHex(t)+i.Scalar.ToHex(e)+i.Scalar.ToHex(n)+i.Scalar.ToHex(o)}toLinearSpace(){const t=new r;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,o.ToLinearSpace),t.g=Math.pow(this.g,o.ToLinearSpace),t.b=Math.pow(this.b,o.ToLinearSpace),t.a=this.a,this}toGammaSpace(){const t=new r;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,o.ToGammaSpace),t.g=Math.pow(this.g,o.ToGammaSpace),t.b=Math.pow(this.b,o.ToGammaSpace),t.a=this.a,this}}e.Color4=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;const i=n(2),o=n(6),r=n(4);class s{constructor(t,e,n,o){this.normal=new i.Vector3(t,e,n),this.d=o}static FromArray(t){return new s(t[0],t[1],t[2],t[3])}static FromPoints(t,e,n){const i=new s(0,0,0,0);return i.copyFromPoints(t,e,n),i}static FromPositionAndNormal(t,e){const n=new s(0,0,0,0);return e.normalize(),n.normal=e,n.d=-(e.x*t.x+e.y*t.y+e.z*t.z),n}static SignedDistanceToPlaneFromPositionAndNormal(t,e,n){const o=-(e.x*t.x+e.y*t.y+e.z*t.z);return i.Vector3.Dot(n,e)+o}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new s(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let t=this.normal.getHashCode();return t=397*t^(this.d||0),t}normalize(){const t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this}transform(t){const e=r.MathTmp.Matrix[0];o.Matrix.TransposeToRef(t,e);const n=e.m,i=this.normal.x,a=this.normal.y,c=this.normal.z,l=this.d,p=i*n[0]+a*n[1]+c*n[2]+l*n[3],u=i*n[4]+a*n[5]+c*n[6]+l*n[7],h=i*n[8]+a*n[9]+c*n[10]+l*n[11],d=i*n[12]+a*n[13]+c*n[14]+l*n[15];return new s(p,u,h,d)}dotCoordinate(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d}copyFromPoints(t,e,n){const i=e.x-t.x,o=e.y-t.y,r=e.z-t.z,s=n.x-t.x,a=n.y-t.y,c=n.z-t.z,l=o*c-r*a,p=r*s-i*c,u=i*a-o*s,h=Math.sqrt(l*l+p*p+u*u);let d;return d=0!==h?1/h:0,this.normal.x=l*d,this.normal.y=p*d,this.normal.z=u*d,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this}isFrontFacingTo(t,e){return i.Vector3.Dot(this.normal,t)<=e}signedDistanceTo(t){return i.Vector3.Dot(t,this.normal)+this.d}}e.Plane=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildArray=void 0,e.buildArray=function(t,e){const n=[];for(let i=0;i<t;++i)n.push(e());return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Axis=void 0;const i=n(2);class o{}e.Axis=o,o.X=new i.Vector3(1,0,0),o.Y=new i.Vector3(0,1,0),o.Z=new i.Vector3(0,0,1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BezierCurve=void 0;e.BezierCurve=class{static Interpolate(t,e,n,i,o){const r=1-3*i+3*e,s=3*i-6*e,a=3*e;let c=t;for(let e=0;e<5;e++){const e=c*c;c-=(r*(e*c)+s*e+a*c-t)*(1/(3*r*e+2*s*c+a)),c=Math.min(1,Math.max(0,c))}return 3*Math.pow(1-c,2)*c*n+3*(1-c)*Math.pow(c,2)*o+Math.pow(c,3)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Color3=void 0;const i=n(1),o=n(11),r=n(3);class s{constructor(t=0,e=0,n=0){this.r=t,this.g=e,this.b=n}static FromHexString(t){if("#"!==t.substring(0,1)||7!==t.length)return new s(0,0,0);const e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);return s.FromInts(e,n,i)}static FromArray(t,e=0){return new s(t[e],t[e+1],t[e+2])}static FromInts(t,e,n){return new s(t/255,e/255,n/255)}static Lerp(t,e,n){const i=new s(0,0,0);return s.LerpToRef(t,e,n,i),i}static LerpToRef(t,e,n,i){i.r=t.r+(e.r-t.r)*n,i.g=t.g+(e.g-t.g)*n,i.b=t.b+(e.b-t.b)*n}static Red(){return new s(1,0,0)}static Green(){return new s(0,1,0)}static Blue(){return new s(0,0,1)}static Black(){return new s(0,0,0)}static White(){return new s(1,1,1)}static Purple(){return new s(.5,0,.5)}static Magenta(){return new s(1,0,1)}static Yellow(){return new s(1,1,0)}static Gray(){return new s(.5,.5,.5)}static Teal(){return new s(0,1,1)}static Random(){return new s(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let t=this.r||0;return t=397*t^(this.g||0),t=397*t^(this.b||0),t}toArray(t,e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this}toColor4(t=1){return new o.Color4(this.r,this.g,this.b,t)}asArray(){const t=new Array;return this.toArray(t,0),t}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(t){return new s(this.r*t.r,this.g*t.g,this.b*t.b)}multiplyToRef(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this}equals(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b}equalsFloats(t,e,n){return this.r===t&&this.g===e&&this.b===n}scale(t){return new s(this.r*t,this.g*t,this.b*t)}scaleToRef(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this}scaleAndAddToRef(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this}clampToRef(t=0,e=1,n){return n.r=r.Scalar.Clamp(this.r,t,e),n.g=r.Scalar.Clamp(this.g,t,e),n.b=r.Scalar.Clamp(this.b,t,e),this}add(t){return new s(this.r+t.r,this.g+t.g,this.b+t.b)}addToRef(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this}subtract(t){return new s(this.r-t.r,this.g-t.g,this.b-t.b)}subtractToRef(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this}clone(){return new s(this.r,this.g,this.b)}copyFrom(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyFromFloats(t,e,n){return this.r=t,this.g=e,this.b=n,this}set(t,e,n){return this.copyFromFloats(t,e,n)}toHexString(){const t=255*this.r|0,e=255*this.g|0,n=255*this.b|0;return"#"+r.Scalar.ToHex(t)+r.Scalar.ToHex(e)+r.Scalar.ToHex(n)}toLinearSpace(){const t=new s;return this.toLinearSpaceToRef(t),t}toLinearSpaceToRef(t){return t.r=Math.pow(this.r,i.ToLinearSpace),t.g=Math.pow(this.g,i.ToLinearSpace),t.b=Math.pow(this.b,i.ToLinearSpace),this}toGammaSpace(){const t=new s;return this.toGammaSpaceToRef(t),t}toGammaSpaceToRef(t){return t.r=Math.pow(this.r,i.ToGammaSpace),t.g=Math.pow(this.g,i.ToGammaSpace),t.b=Math.pow(this.b,i.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}e.Color3=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Curve3=void 0;const i=n(2);class o{constructor(t){this._length=0,this._points=t,this._length=this._computeLength(t)}static CreateQuadraticBezier(t,e,n,r){r=r>2?r:3;const s=new Array,a=(t,e,n,i)=>(1-t)*(1-t)*e+2*t*(1-t)*n+t*t*i;for(let o=0;o<=r;o++)s.push(new i.Vector3(a(o/r,t.x,e.x,n.x),a(o/r,t.y,e.y,n.y),a(o/r,t.z,e.z,n.z)));return new o(s)}static CreateCubicBezier(t,e,n,r,s){s=s>3?s:4;const a=new Array,c=(t,e,n,i,o)=>(1-t)*(1-t)*(1-t)*e+3*t*(1-t)*(1-t)*n+3*t*t*(1-t)*i+t*t*t*o;for(let o=0;o<=s;o++)a.push(new i.Vector3(c(o/s,t.x,e.x,n.x,r.x),c(o/s,t.y,e.y,n.y,r.y),c(o/s,t.z,e.z,n.z,r.z)));return new o(a)}static CreateHermiteSpline(t,e,n,r,s){const a=new Array,c=1/s;for(let o=0;o<=s;o++)a.push(i.Vector3.Hermite(t,e,n,r,o*c));return new o(a)}static CreateCatmullRomSpline(t,e,n){const r=new Array,s=1/e;let a=0;if(n){const n=t.length;for(let o=0;o<n;o++){a=0;for(let c=0;c<e;c++)r.push(i.Vector3.CatmullRom(t[o%n],t[(o+1)%n],t[(o+2)%n],t[(o+3)%n],a)),a+=s}r.push(r[0])}else{const n=new Array;n.push(t[0].clone()),Array.prototype.push.apply(n,t),n.push(t[t.length-1].clone());let o=0;for(o=0;o<n.length-3;o++){a=0;for(let t=0;t<e;t++)r.push(i.Vector3.CatmullRom(n[o],n[o+1],n[o+2],n[o+3],a)),a+=s}o--,r.push(i.Vector3.CatmullRom(n[o],n[o+1],n[o+2],n[o+3],a))}return new o(r)}getPoints(){return this._points}length(){return this._length}continue(t){const e=this._points[this._points.length-1],n=this._points.slice(),i=t.getPoints();for(let t=1;t<i.length;t++)n.push(i[t].subtract(i[0]).add(e));return new o(n)}_computeLength(t){let e=0;for(let n=1;n<t.length;n++)e+=t[n].subtract(t[n-1]).length();return e}}e.Curve3=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Frustum=void 0;const i=n(12);class o{static GetPlanes(t){const e=[];for(let t=0;t<6;t++)e.push(new i.Plane(0,0,0,0));return o.GetPlanesToRef(t,e),e}static GetNearPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]+n[2],e.normal.y=n[7]+n[6],e.normal.z=n[11]+n[10],e.d=n[15]+n[14],e.normalize()}static GetFarPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]-n[2],e.normal.y=n[7]-n[6],e.normal.z=n[11]-n[10],e.d=n[15]-n[14],e.normalize()}static GetLeftPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]+n[0],e.normal.y=n[7]+n[4],e.normal.z=n[11]+n[8],e.d=n[15]+n[12],e.normalize()}static GetRightPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]-n[0],e.normal.y=n[7]-n[4],e.normal.z=n[11]-n[8],e.d=n[15]-n[12],e.normalize()}static GetTopPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]-n[1],e.normal.y=n[7]-n[5],e.normal.z=n[11]-n[9],e.d=n[15]-n[13],e.normalize()}static GetBottomPlaneToRef(t,e){const n=t.m;e.normal.x=n[3]+n[1],e.normal.y=n[7]+n[5],e.normal.z=n[11]+n[9],e.d=n[15]+n[13],e.normalize()}static GetPlanesToRef(t,e){o.GetNearPlaneToRef(t,e[0]),o.GetFarPlaneToRef(t,e[1]),o.GetLeftPlaneToRef(t,e[2]),o.GetRightPlaneToRef(t,e[3]),o.GetTopPlaneToRef(t,e[4]),o.GetBottomPlaneToRef(t,e[5])}}e.Frustum=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Path2=void 0;const i=n(7),o=n(10),r=n(1);class s{constructor(t,e){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new i.Vector2(t,e))}static StartingAt(t,e){return new s(t,e)}addLineTo(t,e){if(this.closed)return this;const n=new i.Vector2(t,e),o=this._points[this._points.length-1];return this._points.push(n),this._length+=n.subtract(o).length(),this}addArcTo(t,e,n,s,a=36){if(this.closed)return this;const c=this._points[this._points.length-1],l=new i.Vector2(t,e),p=new i.Vector2(n,s),u=new o.Arc2(c,l,p);let h=u.angle.radians()/a;u.orientation===r.Orientation.CW&&(h*=-1);let d=u.startAngle.radians()+h;for(let t=0;t<a;t++){const t=Math.cos(d)*u.radius+u.centerPoint.x,e=Math.sin(d)*u.radius+u.centerPoint.y;this.addLineTo(t,e),d+=h}return this}close(){return this.closed=!0,this}length(){let t=this._length;if(!this.closed){const e=this._points[this._points.length-1];t+=this._points[0].subtract(e).length()}return t}getPoints(){return this._points}getPointAtLengthPosition(t){if(t<0||t>1)return i.Vector2.Zero();const e=t*this.length();let n=0;for(let t=0;t<this._points.length;t++){const o=(t+1)%this._points.length,r=this._points[t],s=this._points[o].subtract(r),a=s.length()+n;if(e>=n&&e<=a){const t=s.normalize(),o=e-n;return new i.Vector2(r.x+t.x*o,r.y+t.y*o)}n=a}return i.Vector2.Zero()}}e.Path2=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Path3D=void 0;const i=n(2),o=n(1),r=n(3);e.Path3D=class{constructor(t,e=null,n){this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let e=0;e<t.length;e++)this._curve[e]=t[e].clone();this._raw=n||!1,this._compute(e)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(t,e=null){for(let e=0;e<t.length;e++)this._curve[e].x=t[e].x,this._curve[e].y=t[e].y,this._curve[e].z=t[e].z;return this._compute(e),this}_compute(t){const e=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[e-1]=this._curve[e-1].subtract(this._curve[e-2]),this._raw||this._tangents[e-1].normalize();const n=this._tangents[0],o=this._normalVector(this._curve[0],n,t);let r,s,a,c;this._normals[0]=o,this._raw||this._normals[0].normalize(),this._binormals[0]=i.Vector3.Cross(n,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let t=1;t<e;t++)r=this._getLastNonNullVector(t),t<e-1&&(s=this._getFirstNonNullVector(t),this._tangents[t]=r.add(s),this._tangents[t].normalize()),this._distances[t]=this._distances[t-1]+r.length(),a=this._tangents[t],c=this._binormals[t-1],this._normals[t]=i.Vector3.Cross(c,a),this._raw||this._normals[t].normalize(),this._binormals[t]=i.Vector3.Cross(a,this._normals[t]),this._raw||this._binormals[t].normalize()}_getFirstNonNullVector(t){let e=1,n=this._curve[t+e].subtract(this._curve[t]);for(;0===n.length()&&t+e+1<this._curve.length;)e++,n=this._curve[t+e].subtract(this._curve[t]);return n}_getLastNonNullVector(t){let e=1,n=this._curve[t].subtract(this._curve[t-e]);for(;0===n.length()&&t>e+1;)e++,n=this._curve[t].subtract(this._curve[t-e]);return n}_normalVector(t,e,n){let s,a=e.length();if(0===a&&(a=1),null==n){let t;t=r.Scalar.WithinEpsilon(Math.abs(e.y)/a,1,o.Epsilon)?r.Scalar.WithinEpsilon(Math.abs(e.x)/a,1,o.Epsilon)?r.Scalar.WithinEpsilon(Math.abs(e.z)/a,1,o.Epsilon)?i.Vector3.Zero():new i.Vector3(0,0,1):new i.Vector3(1,0,0):new i.Vector3(0,-1,0),s=i.Vector3.Cross(e,t)}else s=i.Vector3.Cross(e,n),i.Vector3.CrossToRef(s,e,s);return s.normalize(),s}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0;class i{constructor(t,e){this.width=t,this.height=e}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}static Lerp(t,e,n){const o=t.width+(e.width-t.width)*n,r=t.height+(e.height-t.height)*n;return new i(o,r)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let t=this.width||0;return t=397*t^(this.height||0),t}copyFrom(t){this.width=t.width,this.height=t.height}copyFromFloats(t,e){return this.width=t,this.height=e,this}set(t,e){return this.copyFromFloats(t,e)}multiplyByFloats(t,e){return new i(this.width*t,this.height*e)}clone(){return new i(this.width,this.height)}equals(t){return!!t&&(this.width===t.width&&this.height===t.height)}add(t){return new i(this.width+t.width,this.height+t.height)}subtract(t){return new i(this.width-t.width,this.height-t.height)}}e.Size=i},function(t,e,n){"use strict";n.r(e);!function(){function t(){}t.AVATAR={getEntityRepresentation:function(t){return t.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(t){return t.firstPersonCameraEntity}}}();var i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},o=function(t,e,n){if(n||2===arguments.length)for(var i,o=0,r=e.length;o<r;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},r=0;function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];"undefined"!=typeof dcl?dcl.log.apply(dcl,o([],i(t),!1)):console.log.apply(console,o(["DEBUG:"],i(t),!1))}function a(t,e){"undefined"!=typeof dcl?dcl.error(t,e):console.error("ERROR:",t,e)}function c(t){if(r++,0===t.length)throw new Error("newId(type: string): type cannot be empty");return t+r.toString(36)}function l(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}var p=[];function u(t){if(!("__event_name__"in t)||"string"!=typeof t.__event_name__)throw new Error("The EventConstructor is not registered");return t.__event_name__}var h=function(){function t(){this.listeners={}}return t.prototype.addListener=function(t,e,n){if(!t||"function"!=typeof t)throw new Error("Invalid EventConstructor");var i=u(t),o=this.listeners[i];o||(o=this.listeners[i]=[]);for(var r=0;r<o.length;r++){if(o[r].listener===e)throw new Error("The provided listener is already registered")}return o.push({listener:e,fn:n}),this},t.prototype.removeListener=function(t,e){if(!e||"function"!=typeof e)throw new Error("Invalid EventConstructor");var n=u(e),i=this.listeners[n];if(!i)return!1;for(var o=0;o<i.length;o++){if(i[o].listener===t)return i.splice(o,1),!0}return!1},t.prototype.fireEvent=function(t){var e=u(t.constructor),n=this.listeners[e];if(n)for(var i=0;i<n.length;i++)try{var o=n[i];o.fn.call(o.listener,t)}catch(t){a(t)}return this},t}();function d(){var t=c("EV");if(-1!==p.indexOf(t))throw new Error("The event name "+t+" is already taken");return p.push(t),function(e){return e.__event_name__=t,e}}var y,f=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},m=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},g=function(){function t(t,e,n){this.entity=t,this.componentName=e,this.component=n}return t=f([d(),m("design:paramtypes",[Object,String,Object])],t)}(),v=function(){function t(t,e,n){this.entity=t,this.componentName=e,this.classId=n}return t=f([d(),m("design:paramtypes",[Object,String,Object])],t)}(),_=function(){function t(t,e){this.entity=t,this.parent=e}return t=f([d(),m("design:paramtypes",[Object,Object])],t)}();!function(t){t[t.PERCENT=0]="PERCENT",t[t.PIXELS=1]="PIXELS"}(y||(y={}));var b=function(){function t(t){if(this.type=y.PIXELS,"string"==typeof t){var e=t;e.indexOf("px")>-1?this.type=y.PIXELS:e.indexOf("%")>-1&&(this.type=y.PERCENT),this.value=parseFloat(e)}else this.value=t}return t.prototype.toString=function(){var t=this.value.toString();return this.type===y.PERCENT?t+="%":t+="px",t},t}(),w=function(){return(w=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},x=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},T=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},R=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},A=function(t,e,n){if(n||2===arguments.length)for(var i,o=0,r=e.length;o<r;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},E=function(){function t(t,e,n){this.componentId=t,this.componentName=e,this.classId=n}return t=x([d(),T("design:paramtypes",[String,String,Number])],t)}(),S=function(){function t(t){this.componentId=t}return t=x([d(),T("design:paramtypes",[String])],t)}(),O=function(){function t(t,e){this.componentId=t,this.component=e}return t=x([d(),T("design:paramtypes",[String,Object])],t)}();function C(t,e){return function(n){if(n.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+n.originalClassName+" with: "+t);var i=n,o=function(){var n=Array.prototype.slice.call(arguments),o=new(i.bind.apply(i,A([void 0],R(n),!1)));return Object.defineProperty(o,"__name__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:t}),void 0!==e&&Object.defineProperty(o,"__classId__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:e}),o};return void 0!==e&&(o.__classId__symbol_=e),o.__name__symbol_=t,o.isComponent=!0,o.originalClassName=t,(o.prototype=n.prototype).constructor=n,o}}function z(t,e){return function(n){if(n.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+n.originalClassName+" with: "+t);if("number"!=typeof e||isNaN(e))throw new Error("classId: "+e+" is an invalid integer");var i=n,o=function(){if(!z.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var n=Array.prototype.slice.call(arguments),o=new(i.bind.apply(i,A([void 0],R(n),!1))),r=c("C");return Object.defineProperty(o,"__name__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:t}),Object.defineProperty(o,"__component__id_",{enumerable:!1,writable:!1,configurable:!1,value:r}),void 0!==e&&Object.defineProperty(o,"__classId__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:e}),z.engine&&z.engine.registerComponent(o),o};return void 0!==e&&(o.__classId__symbol_=e),o.__name__symbol_=t,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=t,(o.prototype=n.prototype).constructor=n,o}}function P(t){if(!t)throw new TypeError(t+" is not a component.");if(t.__name__symbol_)return t.__name__symbol_;throw new TypeError(t+" is not a registered component.")}function M(t){if(!t)throw new TypeError(t+" is not a component.");if(t.__classId__symbol_)return t.__classId__symbol_;if(!t.__name__symbol_)throw new TypeError(t+" is not a registered component.");return null}function I(t){if(!t)throw new TypeError(t+" is not a component.");if(t.__component__id_)return t.__component__id_;throw new TypeError(t+" is not a registered disposable component.")}!function(t){t.engine=null}(z||(z={}));var N=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(t,e){if(delete t[e]){var n=e+"_"+Math.random();t[n]=void 0,Object.defineProperty(t,n,w(w({},Object.getOwnPropertyDescriptor(t,n)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[n]},set:function(t){var i=this[n];if(this.data[e]=t?I(t):null,this[n]=t,t!==i){this.dirty=!0;for(var o=0;o<this.subscriptions.length;o++)this.subscriptions[o](e,t,i)}},enumerable:!0})}},t.field=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e]},set:function(t){var n=this.data[e];if(this.data[e]=t,t!==n){this.dirty=!0;for(var i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,n)}},enumerable:!0})},t.uiValue=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e].toString()},set:function(t){var n=this.data[e],i=new b(t);if(this.data[e]=i,i!==n){this.dirty=!0;for(var o=0;o<this.subscriptions.length;o++)this.subscriptions[o](e,i,n)}},enumerable:!0})},t.readonly=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){if(e in this.data==!1)throw new Error("The field "+e+" is uninitialized");return this.data[e]},set:function(t){if(e in this.data)throw new Error("The field "+e+" is readonly");this.data[e]=t,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(t){return this.subscriptions.push(t),this},t.prototype.toJSON=function(){return this.data},t}();function F(t){return"__component__id_"in t}var L=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.entities=[],this.active=!1,this._requiresNames=[],!t)throw new Error("ComponentGroup: Could not load the requires list");if(!(t instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return t.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(e){var n=t[e],o=null;if(!n)throw new Error("ComponentGroup: the required component at location "+e+" is invalid");try{o=P(n)}catch(t){throw new Error("ComponentGroup: the required component at location "+e+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(i._requiresNames.some((function(t){return t===o})))throw new Error("ComponentGroup: the required component list has a repeated name "+o);i._requiresNames.push(o)},i=this,o=0;o<t.length;o++)n(o)}return t.prototype.hasEntity=function(t){return!!t.isAddedToEngine()&&-1!==this.entities.indexOf(t)},t.prototype.addEntity=function(t){if(!t.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(t)&&this.entities.push(t)},t.prototype.removeEntity=function(t){var e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)},t.prototype.componentRemoved=function(t,e){-1!==this._requiresNames.indexOf(e)&&this.removeEntity(t)},t.prototype.meetsRequirements=function(t){for(var e=0;e<this._requiresNames.length;e++){if(!(this._requiresNames[e]in t.components))return!1}return!0},t}(),D=function(){function t(t){this.name=t,this.children={},this.eventManager=null,this.alive=!1,this.uuid=c("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(t){if("function"==typeof t)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof t)throw new Error("You passed a "+typeof t+", an instance of component is expected");var e=P(t);if(this.components[e]){if(this.components[e]===t)return t;this.removeComponent(this.components[e],!1)}return this.addComponent(t)},t.prototype.hasComponent=function(t){var e=typeof t;if("string"!==e&&"object"!==e&&"function"!==e)throw new Error("Entity#has(component): component is not a class, name or instance");if(null===t)return!1;var n="string"===e?t:P(t),i=this.components[n];return!!i&&("object"===e?i===t:"function"!==e||i instanceof t)},t.prototype.getComponent=function(t){var e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#get(component): component is not a class or name");var n="string"===e?t:P(t),i=this.components[n];if(!i)throw new Error('Can not get component "'+n+'" from entity "'+this.identifier+'"');if("function"===e){if(i instanceof t)return i;throw new Error('Can not get component "'+n+'" from entity "'+this.identifier+'" (by instance)')}return i},t.prototype.getComponentOrNull=function(t){var e=typeof t;if("string"!==e&&"function"!==e)throw new Error("Entity#getOrNull(component): component is not a class or name");var n="string"===e?t:P(t),i=this.components[n];return i?"function"===e?i instanceof t?i:null:i:null},t.prototype.getComponentOrCreate=function(t){if("function"!=typeof t)throw new Error("Entity#getOrCreate(component): component is not a class");var e=this.getComponentOrNull(t);return e||(P(e=new t),this.addComponentOrReplace(e)),e},t.prototype.addComponent=function(t){if("object"!=typeof t)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var e=P(t),n=M(t);if(this.components[e])throw new Error('A component of type "'+e+'" is already present in entity "'+this.identifier+'"');this.components[e]=t,this.eventManager&&this.eventManager.fireEvent(new v(this,e,n));var i=t;return"function"==typeof i.addedToEntity&&i.addedToEntity(this),t},t.prototype.removeComponent=function(t,e){void 0===e&&(e=!0);var n=typeof t;if("string"!==n&&"function"!==n&&"object"!==n)throw new Error("Entity#remove(component): component is not a class, class or name");var i="string"===n?t:P(t),o=this.components[i];if(o){if("function"===n)return o instanceof t?(delete this.components[i],void(o&&(e&&this.eventManager&&this.eventManager.fireEvent(new g(this,i,o)),"function"==typeof o.removedFromEntity&&o.removedFromEntity(this)))):void s('Entity Warning: Trying to remove wrong (by constructor) component "'+i+'" from entity "'+this.identifier+'"');delete this.components[i],o&&(e&&this.eventManager&&this.eventManager.fireEvent(new g(this,i,o)),"function"==typeof o.removedFromEntity&&o.removedFromEntity(this))}else s('Entity Warning: Trying to remove inexisting component "'+i+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(t){var e;if(t&&"getEntityRepresentation"in t){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");e=t.getEntityRepresentation(this.engine)}else e=!t&&this.engine?this.engine.rootEntity:t;var n=this.getParent();if(e===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(e===n)return this;var i=this.getCircularAncestor(e);if(i)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+i+'")');return n&&delete n.children[this.uuid],null!==e&&"0"!==e.uuid&&(!e.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),e.isAddedToEngine()&&!this.isAddedToEngine()&&e.engine.addEntity(this)),this._parent=e||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new _(this,e)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(t){for(var e=this.engine?this.engine.rootEntity:null,n=t;n&&n!==e;){var i=n.getParent();if(i===this)return n.uuid;n=i}return null},t.prototype.registerAsChild=function(){var t=this.getParent();this.uuid&&t&&(t.children[this.uuid]=this)},t}(),j=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},B=function(t,e,n){if(n||2===arguments.length)for(var i,o=0,r=e.length;o<r;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))},H=function(){function t(t){this.eventManager=new h,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(v,this,this.componentAddedHandler),this.eventManager.addListener(g,this,this.componentRemovedHandler),this.rootEntity=t,this.firstPersonCameraEntity=new D,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new D,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(t){var e=t.getParent();if(t.isAddedToEngine())return t;for(var n in t.eventManager=this.eventManager,t.engine=this,this._entities[t.uuid]=t,this.checkRequirementsAndAdd(t),e?e.isAddedToEngine()||e===this.rootEntity||s("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+e.uuid):t.setParent(this.rootEntity),t.alive=!0,t.children){var i=t.children[n];i&&(i.isAddedToEngine()||this.addEntity(i))}return t},t.prototype.removeEntity=function(t){var e=t.uuid;if(t.isAddedToEngine()){for(var n in t.components){var i=this._componentGroups[n];if(i)for(var o in i)i[o].removeEntity(t);delete this.entityLists[n][e]}for(var r=0;r<this.simpleSystems.length;r++){var a=this.simpleSystems[r];a.onRemoveEntity&&a.onRemoveEntity(t)}for(var r in t.children){var c=t.children[r];c&&this.removeEntity(c)}return t.alive=!1,t.eventManager=null,delete this._entities[e],!0}for(var n in s("Engine: Trying to remove non existent entity from engine."),t.isAddedToEngine()?s("Engine: Entity id: "+e):s('Engine: Entity "'+t.uuid+'" has not been added to any engine yet.'),s("Engine: Entity's components:"),t.components)s(n);return!1},t.prototype.addSystem=function(t,e){if(void 0===e&&(e=0),-1!==this.addedSystems.indexOf(t))return s("Engine: Trying to add a system that is already added. Aborting"),t;if(this.systems.length>0)for(var n=0;n<this.systems.length;n++){var i=this.systems[n],o=n===this.systems.length-1;if(i.priority>e){this.addedSystems.push(t),this.systems.splice(n,0,{system:t,priority:e});break}if(o){this.addedSystems.push(t),this.systems.splice(n+1,0,{system:t,priority:e});break}}else this.addedSystems.push(t),this.systems.splice(1,0,{system:t,priority:e});return this.registerSystem(t),t},t.prototype.removeSystem=function(t){var e=this.addedSystems.indexOf(t);if(-1!==e){t.active=!1,t.deactivate&&t.deactivate(),this.addedSystems.splice(e,1);for(var n=0;n<this.systems.length;n++){this.systems[n].system===t&&this.systems.splice(n,1)}return!0}return!1},t.prototype.update=function(t){for(var e in this.systems){var n=this.systems[e].system;if(n.active&&n.update)try{n.update(t)}catch(t){a(t)}}return this},t.prototype.getEntitiesWithComponent=function(t){var e="string"==typeof t?t:P(t);return e in this.entityLists?this.entityLists[e]:this.entityLists[e]={}},t.prototype.registerComponent=function(t){var e=I(t),n=P(t),i=M(t);this._disposableComponents[e]=t,null!==i&&(this.eventManager.fireEvent(new E(e,n,i)),this.eventManager.fireEvent(new O(e,t)))},t.prototype.disposeComponent=function(t){var e=I(t);return delete this._disposableComponents[e]&&(this.eventManager.fireEvent(new S(e)),t.onDispose&&t.onDispose(),!0)},t.prototype.updateComponent=function(t){this.eventManager.fireEvent(new O(I(t),t))},t.prototype.getComponentGroup=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0;if(t.length>0&&(c=this._componentGroups[P(t[0])]))for(var i=t.slice(),o=0;o<c.length;o++){var r=c[o];if(i.length===r.requires.length){for(var s=0;s<i.length&&-1!==r.requires.indexOf(i[s]);s++)s===i.length-1&&(n=r);if(n)break}}if(n)return n;(n=new(L.bind.apply(L,B([void 0],j(t),!1)))).active=!0;var a=n.requiresNames;for(o=0;o<a.length;o++){var c,l=a[o];(c=this._componentGroups[l])||(this._componentGroups[l]=c=[]),-1===c.indexOf(n)&&c.push(n)}for(var p in this._entities)this.checkRequirements(this._entities[p],n);return n},t.prototype.removeComponentGroup=function(t){if(t.active){t.active=!1;for(var e=t.requiresNames,n=0;n<e.length;n++){var i=e[n],o=this._componentGroups[i];if(o){var r=o.indexOf(t);-1!==r&&o.splice(r,1)}}return!0}return!1},t.prototype.registerSystem=function(t){t.active=!0,t.activate&&t.activate(this),this.simpleSystems.push(t)},t.prototype.checkRequirementsAndAdd=function(t){if(t.isAddedToEngine()){for(var e in t.components){e in this.entityLists||(this.entityLists[e]={}),this.entityLists[e][t.uuid]=t;var n=this._componentGroups[e];if(n)for(var i in n)this.checkRequirements(t,n[i])}for(var o=0;o<this.simpleSystems.length;o++){var r=this.simpleSystems[o];r.onAddEntity&&r.onAddEntity(t)}}},t.prototype.checkRequirements=function(t,e){e.meetsRequirements(t)?e.hasEntity(t)||e.addEntity(t):e.hasEntity(t)&&e.removeEntity(t)},t.prototype.componentAddedHandler=function(t){var e,n=t.entity,i=t.componentName;if(n.isAddedToEngine()){this.entityLists[i]?this.entityLists[i][n.uuid]=n:this.entityLists[i]=((e={})[n.uuid]=n,e);var o=this._componentGroups[i];if(o)for(var r in o)this.checkRequirements(n,o[r])}},t.prototype.componentRemovedHandler=function(t){var e=t.entity,n=t.componentName;if(e.isAddedToEngine()){delete this.entityLists[n][e.uuid];var i=this._componentGroups[n];if(i)for(var o in i)this.checkRequirements(e,i[o])}},t}(),V=Promise.resolve().then.bind(Promise.resolve());function U(t){var e=V(t);return e.isComplete=!1,e.then((function(t){e.isComplete=!0,e.result=t,e.didFail=!1})).catch((function(t){e.isComplete=!0,e.error=t,e.didFail=!0,a("executeTask: FAILED "+t.toString(),t)})),e}var k=function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},G=function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},q=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},W=function(){function t(t,e,n,i){void 0===e&&(e=!1),this.initalize(t,e,n,i)}return t.prototype.initalize=function(t,e,n,i){return void 0===e&&(e=!1),this.mask=t,this.skipNextObservers=e,this.target=n,this.currentTarget=i,this},t}(),Y=function(t,e,n){void 0===n&&(n=null),this.callback=t,this.mask=e,this.scope=n,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},X=(function(){function t(){this._observers=null,this._observables=null}t.Watch=function(e,n,i,o){var r,s;void 0===i&&(i=-1),void 0===o&&(o=null);var a=new t;a._observers=new Array,a._observables=e;try{for(var c=q(e),l=c.next();!l.done;l=c.next()){var p=l.value.add(n,i,!1,o);p&&a._observers.push(p)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(r)throw r.error}}return a},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var t=0;t<this._observers.length;t++)this._observables[t].remove(this._observers[t]);this._observers=null,this._observables=null}}(),function(){function t(t){this._observers=new Array,this._onObserverAdded=null,this._eventState=new W(0),t&&(this._onObserverAdded=t)}return t.prototype.add=function(t,e,n,i,o){if(void 0===e&&(e=-1),void 0===n&&(n=!1),void 0===i&&(i=null),void 0===o&&(o=!1),!t)return null;var r=new Y(t,e,i);return r.unregisterOnNextCall=o,n?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r},t.prototype.addOnce=function(t){return this.add(t,void 0,void 0,void 0,!0)},t.prototype.remove=function(t){return!!t&&(-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0))},t.prototype.removeCallback=function(t,e){for(var n=0;n<this._observers.length;n++)if(this._observers[n].callback===t&&(!e||e===this._observers[n].scope))return this._deferUnregister(this._observers[n]),!0;return!1},t.prototype.notifyObservers=function(t,e,n,i){var o,r;if(void 0===e&&(e=-1),!this._observers.length)return!0;var s=this._eventState;s.mask=e,s.target=n,s.currentTarget=i,s.skipNextObservers=!1,s.lastReturnValue=t;try{for(var a=q(this._observers),c=a.next();!c.done;c=a.next()){var l=c.value;if(!l._willBeUnregistered&&(l.mask&e&&(l.scope?s.lastReturnValue=l.callback.apply(l.scope,[t,s]):s.lastReturnValue=l.callback(t,s),l.unregisterOnNextCall&&this._deferUnregister(l)),s.skipNextObservers))return!1}}catch(t){o={error:t}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return!0},t.prototype.notifyObserversWithPromise=function(t,e,n,i){var o=this;void 0===e&&(e=-1);var r=Promise.resolve(t);if(!this._observers.length)return r;var s=this._eventState;return s.mask=e,s.target=n,s.currentTarget=i,s.skipNextObservers=!1,this._observers.forEach((function(n){s.skipNextObservers||n._willBeUnregistered||n.mask&e&&(r=n.scope?r.then((function(e){return s.lastReturnValue=e,n.callback.apply(n.scope,[t,s])})):r.then((function(e){return s.lastReturnValue=e,n.callback(t,s)})),n.unregisterOnNextCall&&o._deferUnregister(n))})),r.then((function(){return t}))},t.prototype.notifyObserver=function(t,e,n){void 0===n&&(n=-1);var i=this._eventState;i.mask=n,i.skipNextObservers=!1,t.callback(e,i)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var e=new t;return e._observers=this._observers.slice(0),e},t.prototype.hasSpecificMask=function(t){var e,n;void 0===t&&(t=-1);try{for(var i=q(this._observers),o=i.next();!o.done;o=i.next()){var r=o.value;if(r.mask&t||r.mask===t)return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},t.prototype._deferUnregister=function(t){var e=this;t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,U((function(){return k(e,void 0,void 0,(function(){return G(this,(function(e){return[2,this._remove(t)]}))}))}))},t.prototype._remove=function(t){if(!t)return!1;var e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)},t}());var Q,Z=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},J=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},K=function(){function t(t,e){this.uuid=t,this.payload=e}return t=Z([d(),J("design:paramtypes",[String,Object])],t)}(),$=function(){function t(t){this.payload=t}return t=Z([d(),J("design:paramtypes",[Object])],t)}(),tt=function(){function t(t){this.payload=t}return t=Z([d(),J("design:paramtypes",[Object])],t)}();function et(t){return function(){Q&&Q.subscribe(t)}}var nt=new X(et("cameraModeChanged")),it=new X(et("idleStateChanged")),ot=new X(et("onEnterScene")),rt=new X(et("onLeaveScene")),st=new X(et("sceneStart")),at=new X(et("playerExpression")),ct=new X(et("onPointerLock")),lt=new X(et("videoEvent")),pt=new X(et("profileChanged")),ut=new X(et("playerConnected")),ht=new X(et("playerDisconnected")),dt=new X(et("onRealmChanged")),yt=new X(et("playerClicked"));var ft,mt,gt,vt=function(){function t(t){this.dcl=t,this.cachedComponents={}}return t.prototype.activate=function(t){var e=this;this.engine=t,t.eventManager.addListener(v,this,this.componentAdded),t.eventManager.addListener(g,this,this.componentRemoved),t.eventManager.addListener(E,this,this.disposableComponentCreated),t.eventManager.addListener(S,this,this.disposableComponentRemoved),t.eventManager.addListener(O,this,this.disposableComponentUpdated),t.eventManager.addListener(_,this,this.parentChanged);var n=t.rootEntity.uuid;this.dcl.addEntity(n),this.dcl.onUpdate((function(n){t.update(n),e.presentEntities()})),this.dcl.onEvent((function(e){var n=e.data;switch(e.type){case"uuidEvent":t.eventManager.fireEvent(new K(n.uuid,n.payload));break;case"raycastResponse":("HitFirst"===n.queryType||"HitAll"===n.queryType)&&t.eventManager.fireEvent(new $(n));break;case"actionButtonEvent":t.eventManager.fireEvent(new tt(n.payload))}}))},t.prototype.onAddEntity=function(t){if(t&&t.isAddedToEngine()){var e=t.uuid,n=t.getParent();for(var i in this.dcl.addEntity(e),n&&this.dcl.setParent(e,n.uuid),this.cachedComponents[e]={},t.components){var o=t.components[i],r=M(o);if(null!==r)if(F(o))this.dcl.attachEntityComponent(t.uuid,i,I(o));else{var s=JSON.stringify(o);this.dcl.updateEntityComponent(e,i,r,s),this.cachedComponents[e][i]=s}}}},t.prototype.onRemoveEntity=function(t){if(t.isAddedToEngine()){var e=t.uuid;this.dcl.removeEntity(e),delete this.cachedComponents[e]}},t.prototype.presentEntities=function(){for(var t in this.engine.entities){var e=this.engine.entities[t];for(var n in e.components){var i=M(s=e.components[n]);if(null!==i&&!F(s)){var o=this.getJsonIfDirty(e.uuid,n,s);o&&(this.dcl.updateEntityComponent(e.uuid,n,i,o),this.clearDirty(e.uuid,n,s,o))}}}for(var r in this.engine.disposableComponents){var s;(s=this.engine.disposableComponents[r])instanceof N&&s.dirty&&(this.dcl.componentUpdated(r,JSON.stringify(s)),s.dirty=!1)}},t.prototype.componentAdded=function(t){if(t.entity.isAddedToEngine()){var e=t.entity.components[t.componentName];if(F(e))this.dcl.attachEntityComponent(t.entity.uuid,t.componentName,I(e));else if(null!==t.classId){var n=JSON.stringify(e);this.dcl.updateEntityComponent(t.entity.uuid,t.componentName,t.classId,n),this.cachedComponents[t.entity.uuid][t.componentName]=n}}},t.prototype.componentRemoved=function(t){t.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(t.entity.uuid,t.componentName),delete this.cachedComponents[t.entity.uuid][t.componentName])},t.prototype.disposableComponentCreated=function(t){this.dcl.componentCreated(t.componentId,t.componentName,t.classId)},t.prototype.disposableComponentRemoved=function(t){this.dcl.componentDisposed(t.componentId)},t.prototype.disposableComponentUpdated=function(t){this.dcl.componentUpdated(t.componentId,JSON.stringify(t.component))},t.prototype.parentChanged=function(t){this.dcl.setParent(t.entity.uuid,t.parent?t.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(t,e,n){var i=JSON.stringify(n);return i!==this.cachedComponents[t][e]&&i},t.prototype.clearDirty=function(t,e,n,i){this.cachedComponents[t][e]=i},t}(),_t=n(0),bt=(ft=function(t,e){return(ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ft(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),wt=function(){return(wt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},xt=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},Tt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Rt={looping:!0,speed:1,weight:1,layer:0},At=function(t){function e(e,n){void 0===n&&(n=Rt);var i=t.call(this)||this;return i.isAnimationClip=!0,i.looping=Rt.looping,i.weight=Rt.weight,i.playing=!1,i.shouldReset=!1,i.speed=Rt.speed,i.name=c("AnimClip"),i.layer=Rt.layer,i.clip=e,i.setParams(wt({},n)),i}return bt(e,t),e.prototype.setParams=function(t){return this.looping=void 0!==t.looping?t.looping:this.looping,this.speed=t.speed||this.speed,this.weight=t.weight||this.weight,this.layer=t.layer||this.layer,this},e.prototype.toJSON=function(){var e=JSON.parse(JSON.stringify(t.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),e},e.prototype.play=function(t){var e;void 0===t&&(t=!1),null===(e=this.owner)||void 0===e||e.play(this,t)},e.prototype.pause=function(){var t;null===(t=this.owner)||void 0===t||t.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var t;null===(t=this.owner)||void 0===t||t.stop(this)},xt([N.readonly,Tt("design:type",String)],e.prototype,"clip",void 0),xt([N.field,Tt("design:type",Boolean)],e.prototype,"looping",void 0),xt([N.field,Tt("design:type",Number)],e.prototype,"weight",void 0),xt([N.field,Tt("design:type",Boolean)],e.prototype,"playing",void 0),xt([N.field,Tt("design:type",Boolean)],e.prototype,"shouldReset",void 0),xt([N.field,Tt("design:type",Number)],e.prototype,"speed",void 0),xt([N.readonly,Tt("design:type",String)],e.prototype,"name",void 0),e}(N);!function(t){t[t.DOWN=0]="DOWN",t[t.UP=1]="UP"}(mt||(mt={})),function(t){t[t.FirstPerson=0]="FirstPerson",t[t.ThirdPerson=1]="ThirdPerson",t[t.BuildingToolGodMode=2]="BuildingToolGodMode"}(gt||(gt={}));var Et;!function(t){t.OWNER="owner",t.OPERATOR="operator"}(Et||(Et={}));var St,Ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ct=function(){return(Ct=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},zt=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};!function(t){t.POINTER="POINTER",t.PRIMARY="PRIMARY",t.SECONDARY="SECONDARY",t.ANY="ANY",t.FORWARD="FORWARD",t.BACKWARD="BACKWARD",t.RIGHT="RIGHT",t.LEFT="LEFT",t.JUMP="JUMP",t.WALK="WALK",t.ACTION_3="ACTION_3",t.ACTION_4="ACTION_4",t.ACTION_5="ACTION_5",t.ACTION_6="ACTION_6"}(St||(St={}));var Pt,Mt,It=function(t){if(this.callback=t,!t||!("apply"in t)||!("call"in t))throw new Error("Callback is not a function");Dt.ensureInstance()},Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ot(e,t),e=zt([C("pointerDown")],e)}(It),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ot(e,t),e=zt([C("pointerUp")],e)}(It),Lt=function(t,e){this.fn=t,this.useRaycast=e},Dt=function(){function t(){this.buttonIdMapping=[St.POINTER,St.PRIMARY,St.SECONDARY,St.ANY,St.FORWARD,St.BACKWARD,St.RIGHT,St.LEFT,St.JUMP,St.WALK,St.ACTION_3,St.ACTION_4,St.ACTION_5,St.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(t,e){var n;return Ct(Ct({},t),((n={})[e]={BUTTON_DOWN:[],BUTTON_UP:[]},n))}),{}),this.internalState=this.buttonIdMapping.reduce((function(t,e){var n;return Ct(Ct({},t),((n={})[e]={BUTTON_DOWN:!1},n))}),{})}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.isButtonPressed=function(t){return this.internalState[t]},t.prototype.subscribe=function(t,e,n,i){var o=this;return this.subscriptions[e][t].push(new Lt(i,n)),function(){o.unsubscribe(t,e,i)}},t.prototype.unsubscribe=function(t,e,n){var i=this.getSubscriptionId(t,e,n);return i>-1&&this.subscriptions[e][t].splice(i,1)},t.prototype.handlePointerEvent=function(t){var e=this.getPointerById(t.buttonId);if(e){var n=Ct(Ct({},t),{button:e,direction:(new _t.Vector3).copyFrom(t.direction),origin:(new _t.Vector3).copyFrom(t.origin),hit:void 0}),i=t.hit?Ct(Ct({},t.hit),{hitPoint:(new _t.Vector3).copyFrom(t.hit.hitPoint),normal:(new _t.Vector3).copyFrom(t.hit.normal),worldNormal:(new _t.Vector3).copyFrom(t.hit.worldNormal)}):void 0;if(t.type===mt.DOWN){this.internalState[e].BUTTON_DOWN=!0;for(var o=0;o<this.subscriptions[e].BUTTON_DOWN.length;o++){(r=this.subscriptions[e].BUTTON_DOWN[o]).useRaycast?n.hit=i:n.hit=void 0,r.fn(n)}if(i&&i.entityId&&z.engine)(a=(s=z.engine.entities[i.entityId])&&s.getComponentOrNull(Nt))&&(n.hit=i,a.callback(n))}else{this.internalState[e].BUTTON_DOWN=!1;for(o=0;o<this.subscriptions[e].BUTTON_UP.length;o++){var r;(r=this.subscriptions[e].BUTTON_UP[o]).useRaycast?n.hit=i:n.hit=void 0,r.fn(n)}var s,a;if(i&&i.entityId&&z.engine)(a=(s=z.engine.entities[i.entityId])&&s.getComponentOrNull(Ft))&&(n.hit=i,a.callback(n))}}},t.prototype.getSubscriptionId=function(t,e,n){for(var i=0;i<this.subscriptions[e][t].length;i++)if(this.subscriptions[e][t][i].fn===n)return i;return-1},t.prototype.getPointerById=function(t){if(t<0||t>=this.buttonIdMapping.length)return null;var e=this.buttonIdMapping[t];return e===St.ANY?null:e},t}(),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Bt=function(){return(Bt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ht=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},Vt=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t[t.TRANSFORM=1]="TRANSFORM",t[t.UUID_CALLBACK=8]="UUID_CALLBACK",t[t.BOX_SHAPE=16]="BOX_SHAPE",t[t.SPHERE_SHAPE=17]="SPHERE_SHAPE",t[t.PLANE_SHAPE=18]="PLANE_SHAPE",t[t.CONE_SHAPE=19]="CONE_SHAPE",t[t.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",t[t.TEXT_SHAPE=21]="TEXT_SHAPE",t[t.NFT_SHAPE=22]="NFT_SHAPE",t[t.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",t[t.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",t[t.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",t[t.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",t[t.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",t[t.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",t[t.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",t[t.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",t[t.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",t[t.BILLBOARD=32]="BILLBOARD",t[t.ANIMATION=33]="ANIMATION",t[t.FONT=34]="FONT",t[t.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",t[t.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",t[t.GLTF_SHAPE=54]="GLTF_SHAPE",t[t.OBJ_SHAPE=55]="OBJ_SHAPE",t[t.AVATAR_SHAPE=56]="AVATAR_SHAPE",t[t.BASIC_MATERIAL=64]="BASIC_MATERIAL",t[t.PBR_MATERIAL=65]="PBR_MATERIAL",t[t.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",t[t.SOUND=67]="SOUND",t[t.TEXTURE=68]="TEXTURE",t[t.VIDEO_CLIP=70]="VIDEO_CLIP",t[t.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",t[t.AVATAR_TEXTURE=72]="AVATAR_TEXTURE",t[t.AUDIO_CLIP=200]="AUDIO_CLIP",t[t.AUDIO_SOURCE=201]="AUDIO_SOURCE",t[t.AUDIO_STREAM=202]="AUDIO_STREAM",t[t.GIZMOS=203]="GIZMOS",t[t.SMART_ITEM=204]="SMART_ITEM",t[t.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",t[t.AVATAR_ATTACH=206]="AVATAR_ATTACH",t[t.CAMERA_MODE_AREA=207]="CAMERA_MODE_AREA",t[t.NAME=300]="NAME",t[t.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",t[t.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT"}(Pt||(Pt={})),function(t){t.HIDE_AVATARS="HIDE_AVATARS",t.DISABLE_PASSPORTS="DISABLE_PASSPORTS"}(Mt||(Mt={}));!function(t){function e(e){var n=t.call(this)||this;return n.area=e.area,n.modifiers=e.modifiers,n.excludeIds=e.excludeIds,n}jt(e,t),Ht([N.field,Vt("design:type",Object)],e.prototype,"area",void 0),Ht([N.field,Vt("design:type",Array)],e.prototype,"modifiers",void 0),Ht([N.field,Vt("design:type",Array)],e.prototype,"excludeIds",void 0),e=Ht([C("engine.avatarModifierArea",Pt.AVATAR_MODIFIER_AREA),Vt("design:paramtypes",[Object])],e)}(N);var Ut,kt=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.position=e.position||_t.Vector3.Zero(),n.rotation=e.rotation||_t.Quaternion.Identity,n.scale=e.scale||new _t.Vector3(1,1,1),n}return jt(e,t),Object.defineProperty(e.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),e.prototype.lookAt=function(t,e){void 0===e&&(e=_t.MathTmp.staticUp);var n=new _t.Matrix;return _t.Matrix.LookAtLHToRef(this.position,t,e,n),n.invert(),_t.Quaternion.FromRotationMatrixToRef(n,this.rotation),this},e.prototype.rotate=function(t,e){return this.rotation.multiplyInPlace(this.rotation.angleAxis(e,t)),this},e.prototype.translate=function(t){return this.position.addInPlace(t),this},Ht([N.field,Vt("design:type",_t.Vector3)],e.prototype,"position",void 0),Ht([N.field,Vt("design:type",_t.Quaternion)],e.prototype,"rotation",void 0),Ht([N.field,Vt("design:type",_t.Vector3)],e.prototype,"scale",void 0),e=Ht([C("engine.transform",Pt.TRANSFORM),Vt("design:paramtypes",[Object])],e)}(N);!function(t){t[t.Position=0]="Position",t[t.NameTag=1]="NameTag",t[t.LeftHand=2]="LeftHand",t[t.RightHand=3]="RightHand"}(Ut||(Ut={}));(function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.avatarId=e.avatarId||"",n.anchorPointId=e.anchorPointId||Ut.Position,n}jt(e,t),Ht([N.field,Vt("design:type",String)],e.prototype,"avatarId",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"anchorPointId",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"avatarSceneId",void 0),e=Ht([C("engine.transform",Pt.AVATAR_ATTACH),Vt("design:paramtypes",[Object])],e)})(N),function(t){function e(e,n,i){void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0);var o=t.call(this)||this;return o.x=!0,o.y=!0,o.z=!0,o.x=e,o.y=n,o.z=i,o}jt(e,t),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"x",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"y",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"z",void 0),e=Ht([C("engine.billboard",Pt.BILLBOARD),Vt("design:paramtypes",[Boolean,Boolean,Boolean])],e)}(N);var Gt,qt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.withCollisions=!0,e.isPointerBlocker=!0,e.visible=!0,e}return jt(e,t),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"withCollisions",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"visible",void 0),e}(N);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}jt(e,t),Ht([N.field,Vt("design:type",Array)],e.prototype,"uvs",void 0),e=Ht([z("engine.shape",Pt.BOX_SHAPE)],e)})(qt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}jt(e,t),e=Ht([z("engine.shape",Pt.SPHERE_SHAPE)],e)}(qt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"segments",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"arc",void 0),e=Ht([z("engine.shape",Pt.CIRCLE_SHAPE)],e)}(qt),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=1,e.height=1,e}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"width",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"height",void 0),Ht([N.field,Vt("design:type",Array)],e.prototype,"uvs",void 0),e=Ht([z("engine.shape",Pt.PLANE_SHAPE)],e)}(qt),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radiusTop=0,e.radiusBottom=1,e.segmentsHeight=1,e.segmentsRadial=36,e.openEnded=!1,e.radius=null,e.arc=360,e}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"radiusTop",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"radiusBottom",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"segmentsHeight",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"segmentsRadial",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"openEnded",void 0),Ht([N.field,Vt("design:type",Object)],e.prototype,"radius",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"arc",void 0),e=Ht([z("engine.shape",Pt.CONE_SHAPE)],e)}(qt),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radiusTop=1,e.radiusBottom=1,e.segmentsHeight=1,e.segmentsRadial=36,e.openEnded=!1,e.radius=null,e.arc=360,e}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"radiusTop",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"radiusBottom",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"segmentsHeight",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"segmentsRadial",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"openEnded",void 0),Ht([N.field,Vt("design:type",Object)],e.prototype,"radius",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"arc",void 0),e=Ht([z("engine.shape",Pt.CYLINDER_SHAPE)],e)}(qt),function(t){function e(e){var n=t.call(this)||this;return n.src=e,n}jt(e,t),Ht([qt.readonly,Vt("design:type",String)],e.prototype,"src",void 0),e=Ht([z("engine.shape",Pt.GLTF_SHAPE),Vt("design:paramtypes",[String])],e)}(qt);!function(t){t[t.Classic=0]="Classic",t[t.Baroque_Ornament=1]="Baroque_Ornament",t[t.Diamond_Ornament=2]="Diamond_Ornament",t[t.Minimal_Wide=3]="Minimal_Wide",t[t.Minimal_Grey=4]="Minimal_Grey",t[t.Blocky=5]="Blocky",t[t.Gold_Edges=6]="Gold_Edges",t[t.Gold_Carved=7]="Gold_Carved",t[t.Gold_Wide=8]="Gold_Wide",t[t.Gold_Rounded=9]="Gold_Rounded",t[t.Metal_Medium=10]="Metal_Medium",t[t.Metal_Wide=11]="Metal_Wide",t[t.Metal_Slim=12]="Metal_Slim",t[t.Metal_Rounded=13]="Metal_Rounded",t[t.Pins=14]="Pins",t[t.Minimal_Black=15]="Minimal_Black",t[t.Minimal_White=16]="Minimal_White",t[t.Tape=17]="Tape",t[t.Wood_Slim=18]="Wood_Slim",t[t.Wood_Wide=19]="Wood_Wide",t[t.Wood_Twigs=20]="Wood_Twigs",t[t.Canvas=21]="Canvas",t[t.None=22]="None"}(Gt||(Gt={}));(function(t){function e(e,n){void 0===n&&(n={});var i=t.call(this)||this;i.src=e;var o=new _t.Color3(.6404918,.611472,.8584906),r=Gt.Classic;return"r"in n?o=n:null!==n&&(n.color&&(o=n.color),n.style&&(r=n.style)),i.color=o,i.style=r,i}jt(e,t),Ht([qt.readonly,Vt("design:type",String)],e.prototype,"src",void 0),Ht([qt.readonly,Vt("design:type",Number)],e.prototype,"style",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"color",void 0),e=Ht([z("engine.shape",Pt.NFT_SHAPE),Vt("design:paramtypes",[String,Object])],e)})(qt),function(t){function e(e,n){var i=t.call(this)||this,o=new RegExp("data:[a-z-]+/[a-z-]+;base64");if((e.length>2048||o.test(e))&&s(" Base64 textures will be deprecated in version 7 of decentraland-ecs"),i.src=e,n)for(var r in n){i[r]=n[r]}return i}jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"src",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"samplingMode",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"wrap",void 0),Ht([N.readonly,Vt("design:type",Boolean)],e.prototype,"hasAlpha",void 0),e=Ht([z("engine.texture",Pt.TEXTURE),Vt("design:paramtypes",[String,Object])],e)}(N),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.states=[],e}jt(e,t),e.prototype.addClip=function(t){var e=this;return this.states.push(t),t.onChange((function(){e.dirty=!0})),t.owner=this,this},e.prototype.getClip=function(t){for(var e=0;e<this.states.length;e++){var n=this.states[e];if(n.clip===t)return n}var i=new At(t);return this.addClip(i),i},e.prototype.stop=function(t){if(t)t.playing=!1,t.shouldReset=!0;else for(var e=0;e<this.states.length;e++){var n=this.states[e];this.stop(n)}},e.prototype.play=function(t,e){void 0===e&&(e=!1);for(var n=0;n<this.states.length;n++){var i=this.states[n];i.layer===t.layer&&t!==i&&this.pause(i)}e&&(t.shouldReset=!0),t.playing=!0,t.dirty=!0,t.data.nonce=Math.random()},e.prototype.pause=function(t){if(t)t.playing=!1;else for(var e=0;e<this.states.length;e++){var n=this.states[e];this.pause(n)}},Ht([N.readonly,Vt("design:type",Array)],e.prototype,"states",void 0),e=Ht([C("engine.animator",Pt.ANIMATION)],e)}(qt),function(t){function e(e){var n=t.call(this)||this;return n.src=e,n}jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"src",void 0),e=Ht([z("engine.shape",Pt.OBJ_SHAPE),Vt("design:paramtypes",[String])],e)}(qt);var Wt,Yt=function(t){function e(e){void 0===e&&(e="");var n=t.call(this)||this;return n.src=e,n}return jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"src",void 0),e=Ht([z("engine.font",Pt.FONT),Vt("design:paramtypes",[String])],e)}(N);!function(t){t.SanFrancisco="builtin:SF-UI-Text-Regular SDF",t.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",t.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",t.LiberationSans="builtin:LiberationSans SDF",t.SansSerif="SansSerif",t.SansSerif_Heavy="SansSerif_Heavy",t.SansSerif_Bold="SansSerif_Bold",t.SansSerif_SemiBold="SansSerif_SemiBold"}(Wt||(Wt={}));var Xt;!function(t){function e(e){var n=t.call(this)||this;return n.outlineWidth=0,n.outlineColor=new _t.Color3(1,1,1),n.color=new _t.Color3(1,1,1),n.fontSize=10,n.opacity=1,n.value="",n.lineSpacing="0px",n.lineCount=0,n.textWrapping=!1,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor=new _t.Color3(1,1,1),n.hTextAlign="center",n.vTextAlign="center",n.width=1,n.height=1,n.paddingTop=0,n.paddingRight=0,n.paddingBottom=0,n.paddingLeft=0,n.billboard=!1,n.visible=!0,e&&(n.value=e),n}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"outlineWidth",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"outlineColor",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"color",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"fontSize",void 0),Ht([N.component,Vt("design:type",Yt)],e.prototype,"font",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"opacity",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"value",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"lineSpacing",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"lineCount",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"textWrapping",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"shadowBlur",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"shadowOffsetX",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"shadowOffsetY",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"shadowColor",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"hTextAlign",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"vTextAlign",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"width",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"height",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"paddingTop",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"paddingRight",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"paddingBottom",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"paddingLeft",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"billboard",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"visible",void 0),e=Ht([C("engine.text",Pt.TEXT_SHAPE),Vt("design:paramtypes",[String])],e)}(N);!function(t){t[t.OPAQUE=0]="OPAQUE",t[t.ALPHA_TEST=1]="ALPHA_TEST",t[t.ALPHA_BLEND=2]="ALPHA_BLEND",t[t.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",t[t.AUTO=4]="AUTO"}(Xt||(Xt={}));(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alphaTest=.5,e.castShadows=!0,e.transparencyMode=Xt.AUTO,e}jt(e,t),Ht([N.field,Vt("design:type",Number)],e.prototype,"alphaTest",void 0),Ht([N.field,Vt("design:type",Object)],e.prototype,"albedoColor",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"emissiveColor",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"metallic",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"roughness",void 0),Ht([N.field,Vt("design:type",_t.Color3)],e.prototype,"reflectivityColor",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"directIntensity",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"microSurface",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"emissiveIntensity",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"specularIntensity",void 0),Ht([N.component,Vt("design:type",Object)],e.prototype,"albedoTexture",void 0),Ht([N.component,Vt("design:type",Object)],e.prototype,"alphaTexture",void 0),Ht([N.component,Vt("design:type",Object)],e.prototype,"emissiveTexture",void 0),Ht([N.component,Vt("design:type",Object)],e.prototype,"bumpTexture",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"castShadows",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"transparencyMode",void 0),e=Ht([z("engine.material",Pt.PBR_MATERIAL)],e)})(N),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alphaTest=.5,e.castShadows=!0,e}jt(e,t),Ht([N.component,Vt("design:type",Object)],e.prototype,"texture",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"alphaTest",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"castShadows",void 0),e=Ht([z("engine.material",Pt.BASIC_MATERIAL)],e)}(N);var Qt,Zt=function(t){function e(e){var n=t.call(this)||this;if(n.uuid=c("UUID"),!e||!("apply"in e)||!("call"in e))throw new Error("Callback is not a function");return n.callback=e,n}return jt(e,t),e.uuidEvent=function(t,n){if(delete t[n]){var i=n+"_"+Math.random();t[i]=void 0,Object.defineProperty(t,i,Bt(Bt({},Object.getOwnPropertyDescriptor(t,i)),{enumerable:!1})),Object.defineProperty(t,n.toString(),{get:function(){return this[i]},set:function(t){var o=this[i];if(t){if(!(t instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[n]=t.uuid}else this.data[n]=null;if(this[i]=t,t!==o){this.dirty=!0;for(var r=0;r<this.subscriptions.length;r++)this.subscriptions[r](n,t,o)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},Ht([N.field,Vt("design:type",Function)],e.prototype,"callback",void 0),e}(N),Jt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=St.ANY,e.hoverText="Interact",e.distance=10,e.showFeedback=!0,e}return jt(e,t),e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},Ht([N.field,Vt("design:type",String)],e.prototype,"button",void 0),Ht([N.field,Vt("design:type",String)],e.prototype,"hoverText",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"distance",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"showFeedback",void 0),e}(Zt),Kt=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="onPointerLock",e}jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"type",void 0),e=Ht([C("engine.onPointerLock",Pt.UUID_CALLBACK)],e)}(Zt),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="onAnimationEnd",e}jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"type",void 0),e=Ht([C("engine.onAnimationEnd",Pt.UUID_CALLBACK)],e)}(Zt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}jt(e,t),e=Ht([C("engine.smartItem",Pt.SMART_ITEM)],e)}(N),function(t){function e(e){var n=t.call(this)||this;return n.url=e,n}return jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"url",void 0),e=Ht([z("engine.VideoClip",Pt.VIDEO_CLIP),Vt("design:paramtypes",[String])],e)}(N));!function(t){t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.LOADING=2]="LOADING",t[t.READY=3]="READY",t[t.PLAYING=4]="PLAYING",t[t.BUFFERING=5]="BUFFERING"}(Qt||(Qt={}));(function(t){function e(e,n){var i=t.call(this)||this;if(i.volume=1,i.playbackRate=1,i.loop=!1,i.seek=-1,i._position=-1,i._videoLength=-1,i._status=Qt.NONE,i.playing=!1,!(e instanceof Kt))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(i.videoClipId=I(e),n)for(var o in n){i[o]=n[o]}return i}jt(e,t),e.prototype.play=function(){this.playing=!0},e.prototype.pause=function(){this.playing=!1},e.prototype.reset=function(){this.seekTime(0),this.pause()},e.prototype.seekTime=function(t){this.seek=t,this.dirty=!0,this.data.nonce=Math.random()},e.prototype.toJSON=function(){if(this.seek>=0){var e=JSON.parse(JSON.stringify(t.prototype.toJSON.call(this)));return this.seek=-1,e}return t.prototype.toJSON.call(this)},e.prototype.update=function(t){t.videoClipId===this.videoClipId&&(this._status=t.videoStatus||Qt.NONE,this._videoLength=t.totalVideoLength,this._position=t.currentOffset)},Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Ht([N.readonly,Vt("design:type",String)],e.prototype,"videoClipId",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"samplingMode",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"wrap",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"volume",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"playbackRate",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"loop",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"seek",void 0),Ht([N.field,Vt("design:type",Boolean)],e.prototype,"playing",void 0),e=Ht([z("engine.VideoTexture",Pt.VIDEO_TEXTURE),Vt("design:paramtypes",[Kt,Object])],e)})(N),function(t){function e(e){var n=t.call(this)||this;return n.area=e.area,n.cameraMode=e.cameraMode,n}jt(e,t),Ht([N.field,Vt("design:type",Object)],e.prototype,"area",void 0),Ht([N.field,Vt("design:type",Number)],e.prototype,"cameraMode",void 0),e=Ht([C("engine.cameraModeArea",Pt.CAMERA_MODE_AREA),Vt("design:paramtypes",[Object])],e)}(N),function(t){function e(e,n){var i=t.call(this)||this;if(i.userId=e,n)for(var o in n){i[o]=n[o]}return i}jt(e,t),Ht([N.readonly,Vt("design:type",String)],e.prototype,"userId",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"samplingMode",void 0),Ht([N.readonly,Vt("design:type",Number)],e.prototype,"wrap",void 0),Ht([N.readonly,Vt("design:type",Boolean)],e.prototype,"hasAlpha",void 0),e=Ht([z("engine.texture",Pt.AVATAR_TEXTURE),Vt("design:paramtypes",[String,Object])],e)}(N);var $t,te=function(){function t(){var t=this;this.position=new _t.Vector3,this.rotation=new _t.Quaternion,this.feetPosition=new _t.Vector3,this.worldPosition=new _t.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=gt.ThirdPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(e){switch(e.type){case"positionChanged":t.positionChanged(e.data);break;case"rotationChanged":t.rotationChanged(e.data);break;case"cameraModeChanged":t.cameraModeChanged(e.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return t.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return t.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return t.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return t.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return t.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return t.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return t.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return t.lastEventPosition.y-t.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return t.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return t.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return t.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return t.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return t.lastEventRotation.w}})}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),t.prototype.positionChanged=function(t){this.lastEventPosition=t.position,this.lastEventWorldPosition=t.cameraPosition,this._playerHeight=t.playerHeight},t.prototype.rotationChanged=function(t){this.lastEventRotation=t.quaternion},t.prototype.cameraModeChanged=function(t){this._cameraMode=t.cameraMode},t}();!function(t){t.HitFirst="rqhf",t.HitAll="rqha"}($t||($t={}));var ee,ne=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(t){var e=te.instance.rotation,n=_t.Matrix.Identity();e.toRotationMatrix(n);var i=_t.Vector3.TransformCoordinates(_t.Vector3.Forward(),n);return{origin:te.instance.position,direction:i,distance:t}},t.prototype.getRayFromPositions=function(t,e){var n=e.subtract(t),i=n.length();return{origin:t,direction:n.normalize(),distance:i}},t.prototype.hitFirst=function(t,e,n){var i="number"==typeof n?$t.HitFirst+n:l();this.queries[i]=e,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:i,queryType:"HitFirst",ray:t})},t.prototype.hitAll=function(t,e,n){var i="number"==typeof n?$t.HitAll+n:l();this.queries[i]=e,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:i,queryType:"HitAll",ray:t})},t.prototype.hitFirstAvatar=function(t,e){s("not implemented yet")},t.prototype.hitAllAvatars=function(t,e){s("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]},t}(),ie=function(){function t(){}return t.prototype.activate=function(t){t.eventManager.addListener($,this,(function(t){"HitFirst"===t.payload.queryType?ne.instance.handleRaycastHitFirstResponse(t):"HitAll"===t.payload.queryType&&ne.instance.handleRaycastHitAllResponse(t)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),oe=function(){function t(){}return t.prototype.activate=function(t){t.eventManager.addListener(tt,this,(function(t){Dt.instance.handlePointerEvent(t.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("actionButtonEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("actionButtonEvent"))},t}(),re=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(t){t.eventManager.addListener(K,this,this.handleEvent),t.eventManager.addListener(v,this,this.componentAdded),t.eventManager.addListener(g,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(t){for(var e in t.components){var n=t.components[e];n instanceof Zt&&(this.handlerMap[n.uuid]=n)}},t.prototype.onRemoveEntity=function(t){for(var e in t.components){var n=t.components[e];n instanceof Zt&&delete this.handlerMap[n.uuid]}},t.prototype.componentAdded=function(t){if(t.entity.isAddedToEngine()){var e=t.entity.components[t.componentName];e instanceof Zt&&(this.handlerMap[e.uuid]=e)}},t.prototype.componentRemoved=function(t){t.entity.isAddedToEngine()&&t.component instanceof Zt&&delete this.handlerMap[t.component.uuid]},t.prototype.handleEvent=function(t){if(t.uuid in this.handlerMap){var e=this.handlerMap[t.uuid];e&&e.callback&&"call"in e.callback&&e.callback(t.payload)}},t}(),se=new ie,ae=new oe,ce=new re,le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),pe=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},ue=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},he=function(t){function e(e){var n=t.call(this)||this;return n.loop=!1,n.volume=1,n.url=e,n}return le(e,t),pe([N.readonly,ue("design:type",String)],e.prototype,"url",void 0),pe([N.field,ue("design:type",Boolean)],e.prototype,"loop",void 0),pe([N.field,ue("design:type",String)],e.prototype,"loadingCompleteEventId",void 0),pe([N.field,ue("design:type",Number)],e.prototype,"volume",void 0),e=pe([z("engine.AudioClip",Pt.AUDIO_CLIP),ue("design:paramtypes",[String])],e)}(N),de=(function(t){function e(e){var n=t.call(this)||this;if(n.audioClip=e,n.loop=!1,n.volume=1,n.playing=!1,n.pitch=1,n.playedAtTimestamp=Date.now(),!(e instanceof he))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return n.audioClipId=I(e),n}le(e,t),e.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},pe([N.readonly,ue("design:type",String)],e.prototype,"audioClipId",void 0),pe([N.field,ue("design:type",Boolean)],e.prototype,"loop",void 0),pe([N.field,ue("design:type",Number)],e.prototype,"volume",void 0),pe([N.field,ue("design:type",Boolean)],e.prototype,"playing",void 0),pe([N.field,ue("design:type",Number)],e.prototype,"pitch",void 0),pe([N.field,ue("design:type",Number)],e.prototype,"playedAtTimestamp",void 0),e=pe([C("engine.AudioSource",Pt.AUDIO_SOURCE),ue("design:paramtypes",[he])],e)}(N),function(t){function e(e){var n=t.call(this)||this;return n.playing=!1,n.volume=1,n.url=e,n.playing=!0,n}le(e,t),pe([N.readonly,ue("design:type",String)],e.prototype,"url",void 0),pe([N.field,ue("design:type",Boolean)],e.prototype,"playing",void 0),pe([N.field,ue("design:type",Number)],e.prototype,"volume",void 0),e=pe([C("engine.AudioStream",Pt.AUDIO_STREAM),ue("design:paramtypes",[String])],e)}(N),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}()),ye=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},fe=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};!function(t){t.MOVE="MOVE",t.ROTATE="ROTATE",t.SCALE="SCALE",t.NONE="NONE"}(ee||(ee={}));(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="gizmoEvent",e}de(e,t),ye([N.readonly,fe("design:type",String)],e.prototype,"type",void 0),e=ye([C("engine.gizmoEvent",Pt.UUID_CALLBACK)],e)})(Zt),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.position=!0,e.rotation=!0,e.scale=!0,e.cycle=!0,e.localReference=!1,e}de(e,t),ye([N.field,fe("design:type",Boolean)],e.prototype,"position",void 0),ye([N.field,fe("design:type",Boolean)],e.prototype,"rotation",void 0),ye([N.field,fe("design:type",Boolean)],e.prototype,"scale",void 0),ye([N.field,fe("design:type",Boolean)],e.prototype,"cycle",void 0),ye([N.field,fe("design:type",String)],e.prototype,"selectedGizmo",void 0),ye([N.field,fe("design:type",Boolean)],e.prototype,"localReference",void 0),e=ye([C("engine.gizmos",Pt.GIZMOS)],e)}(N);var me,ge=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ve=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},_e=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},be=(function(t){function e(e){var n=t.call(this,e)||this;return n.type="onFocus",ce.handlerMap[n.uuid]=n,n}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onFocus",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Zt),function(t){function e(e){var n=t.call(this,e)||this;return n.type="onTextSubmit",ce.handlerMap[n.uuid]=n,n}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onTextSubmit",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Zt),function(t){function e(e){var n=t.call(this,e)||this;return n.type="onBlur",ce.handlerMap[n.uuid]=n,n}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onBlur",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Zt),function(t){function e(e){var n=t.call(this,e)||this;return n.type="onEnter",ce.handlerMap[n.uuid]=n,n}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onEnter",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Zt),function(t){function e(e){var n=t.call(this,e)||this;return n.type="onChange",ce.handlerMap[n.uuid]=n,n}return ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onChange",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Zt)),we=(function(t){function e(e,n){var i=t.call(this,e)||this;return i.type="onClick",ce.handlerMap[i.uuid]=i,n&&(i.showFeedback=!(!1===n.showFeedback),n.button&&(i.button=n.button),n.hoverText&&(i.hoverText=n.hoverText),n.distance&&(i.distance=n.distance)),i}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.onClick",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function,Object])],e)}(Jt),function(t){function e(e,n){var i=t.call(this,e)||this;return i.type="pointerDown",ce.handlerMap[i.uuid]=i,n&&(i.showFeedback=!(!1===n.showFeedback),n.button&&(i.button=n.button),n.hoverText&&(i.hoverText=n.hoverText),n.distance&&(i.distance=n.distance)),i}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.pointerDown",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function,Object])],e)}(Jt),function(t){function e(e,n){var i=t.call(this,e)||this;return i.type="pointerUp",ce.handlerMap[i.uuid]=i,n&&(i.showFeedback=!(!1===n.showFeedback),n.button&&(i.button=n.button),n.hoverText&&(i.hoverText=n.hoverText),n.distance&&(i.distance=n.distance)),i}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.pointerUp",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function,Object])],e)}(Jt),function(t){function e(e,n){var i=t.call(this,e)||this;return i.type="pointerHoverEnter",ce.handlerMap[i.uuid]=i,n&&n.distance&&(i.distance=n.distance),i}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.pointerHoverEnter",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function,Object])],e)}(Jt),function(t){function e(e){var n=t.call(this,e)||this;return n.type="pointerHoverExit",ce.handlerMap[n.uuid]=n,n.distance=160,n}ge(e,t),ve([N.readonly,_e("design:type",String)],e.prototype,"type",void 0),e=ve([C("engine.pointerHoverExit",Pt.UUID_CALLBACK),_e("design:paramtypes",[Function])],e)}(Jt),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}()),xe=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},Te=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Re=function(t){function e(e){var n=t.call(this)||this;return n.name=null,n.visible=!0,n.opacity=1,n.hAlign="center",n.vAlign="center",n.width="100px",n.height="50px",n.positionX="0px",n.positionY="0px",n.isPointerBlocker=!0,e&&(n._parent=e,n.data.parentComponent=I(e)),n}return we(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),xe([N.field,Te("design:type",Object)],e.prototype,"name",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"visible",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"opacity",void 0),xe([N.field,Te("design:type",String)],e.prototype,"hAlign",void 0),xe([N.field,Te("design:type",String)],e.prototype,"vAlign",void 0),xe([N.uiValue,Te("design:type",Object)],e.prototype,"width",void 0),xe([N.uiValue,Te("design:type",Object)],e.prototype,"height",void 0),xe([N.uiValue,Te("design:type",Object)],e.prototype,"positionX",void 0),xe([N.uiValue,Te("design:type",Object)],e.prototype,"positionY",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),e}(N);(function(t){function e(){return t.call(this,null)||this}we(e,t),e=xe([z("engine.shape",Pt.UI_FULLSCREEN_SHAPE),Te("design:paramtypes",[])],e)})(Re),function(t){function e(){return t.call(this,null)||this}we(e,t),e=xe([z("engine.shape",Pt.UI_WORLD_SPACE_SHAPE),Te("design:paramtypes",[])],e)}(Re),function(t){function e(){return t.call(this,null)||this}we(e,t),e=xe([z("engine.shape",Pt.UI_SCREEN_SPACE_SHAPE),Te("design:paramtypes",[])],e)}(Re),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.thickness=0,e.color=_t.Color4.Clear(),e.alignmentUsesSize=!0,e}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"thickness",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"color",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"alignmentUsesSize",void 0),e=xe([z("engine.shape",Pt.UI_CONTAINER_RECT)],e)}(Re);!function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(me||(me={}));(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adaptWidth=!0,e.adaptHeight=!0,e.color=_t.Color4.Clear(),e.stackOrientation=me.VERTICAL,e.spacing=0,e}we(e,t),xe([N.field,Te("design:type",Boolean)],e.prototype,"adaptWidth",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"adaptHeight",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"color",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"stackOrientation",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"spacing",void 0),e=xe([z("engine.shape",Pt.UI_CONTAINER_STACK)],e)})(Re),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fontSize=10,e.fontWeight="normal",e.thickness=0,e.cornerRadius=0,e.color=_t.Color4.White(),e.background=_t.Color4.White(),e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.paddingLeft=0,e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor=_t.Color4.Black(),e.text="button",e}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"fontSize",void 0),xe([N.field,Te("design:type",String)],e.prototype,"fontWeight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"thickness",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"cornerRadius",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"color",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"background",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingRight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingBottom",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingLeft",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowBlur",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetX",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetY",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"shadowColor",void 0),xe([N.field,Te("design:type",String)],e.prototype,"text",void 0),e=xe([z("engine.shape",Pt.UI_BUTTON_SHAPE)],e)}(Re),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.outlineWidth=0,e.outlineColor=_t.Color4.White(),e.color=_t.Color4.White(),e.fontSize=10,e.fontAutoSize=!1,e.value="",e.lineSpacing=0,e.lineCount=0,e.adaptWidth=!1,e.adaptHeight=!1,e.textWrapping=!1,e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor=_t.Color4.Black(),e.hTextAlign="left",e.vTextAlign="bottom",e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.paddingLeft=0,e}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"outlineWidth",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"outlineColor",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"color",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"fontSize",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"fontAutoSize",void 0),xe([N.component,Te("design:type",Yt)],e.prototype,"font",void 0),xe([N.field,Te("design:type",String)],e.prototype,"value",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"lineSpacing",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"lineCount",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"adaptWidth",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"adaptHeight",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"textWrapping",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowBlur",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetX",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetY",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"shadowColor",void 0),xe([N.field,Te("design:type",String)],e.prototype,"hTextAlign",void 0),xe([N.field,Te("design:type",String)],e.prototype,"vTextAlign",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingRight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingBottom",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingLeft",void 0),e=xe([z("engine.shape",Pt.UI_TEXT_SHAPE)],e)}(Re),function(t){function e(e){var n=t.call(this,e)||this;return n.outlineWidth=0,n.outlineColor=_t.Color4.Black(),n.color=_t.Color4.Clear(),n.fontSize=10,n.value="",n.placeholder="",n.margin=10,n.hTextAlign="left",n.vTextAlign="bottom",n.focusedBackground=_t.Color4.Black(),n.textWrapping=!1,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor=_t.Color4.White(),n.paddingTop=0,n.paddingRight=0,n.paddingBottom=0,n.paddingLeft=0,n.onTextSubmit=null,n.onChanged=null,n.onFocus=null,n.onBlur=null,n.onTextChanged=new be((function(t){var e=t.value,i=e.value,o=e.isSubmit,r=n.dirty;if(n.value=i,n.dirty=r,o&&n.onTextSubmit){var s={text:i};n.onTextSubmit.callback(s)}else if(!o&&n.onChanged){var a={value:i,pointerId:t.pointerId};n.onChanged.callback(a)}})),n}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"outlineWidth",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"outlineColor",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"color",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"fontSize",void 0),xe([N.component,Te("design:type",Yt)],e.prototype,"font",void 0),xe([N.field,Te("design:type",String)],e.prototype,"value",void 0),xe([N.field,Te("design:type",String)],e.prototype,"placeholder",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"margin",void 0),xe([N.field,Te("design:type",String)],e.prototype,"hTextAlign",void 0),xe([N.field,Te("design:type",String)],e.prototype,"vTextAlign",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"focusedBackground",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"textWrapping",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowBlur",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetX",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"shadowOffsetY",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"shadowColor",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingRight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingBottom",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingLeft",void 0),xe([Zt.uuidEvent,Te("design:type",be)],e.prototype,"onTextChanged",void 0),xe([Zt.uuidEvent,Te("design:type",Object)],e.prototype,"onFocus",void 0),xe([Zt.uuidEvent,Te("design:type",Object)],e.prototype,"onBlur",void 0),e=xe([z("engine.shape",Pt.UI_INPUT_TEXT_SHAPE),Te("design:paramtypes",[Object])],e)}(Re),function(t){function e(e,n){var i=t.call(this,e)||this;return i.sourceLeft=0,i.sourceTop=0,i.sourceWidth=1,i.sourceHeight=1,i.paddingTop=0,i.paddingRight=0,i.paddingBottom=0,i.paddingLeft=0,i.sizeInPixels=!0,i.onClick=null,i.source=n,i}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"sourceLeft",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"sourceTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"sourceWidth",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"sourceHeight",void 0),xe([N.component,Te("design:type",Object)],e.prototype,"source",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingRight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingBottom",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingLeft",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"sizeInPixels",void 0),xe([Zt.uuidEvent,Te("design:type",Object)],e.prototype,"onClick",void 0),e=xe([z("engine.shape",Pt.UI_IMAGE_SHAPE),Te("design:paramtypes",[Re,Object])],e)}(Re),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueX=0,e.valueY=0,e.backgroundColor=_t.Color4.Clear(),e.isHorizontal=!1,e.isVertical=!1,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.paddingLeft=0,e.onChanged=null,e}we(e,t),xe([N.field,Te("design:type",Number)],e.prototype,"valueX",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"valueY",void 0),xe([N.field,Te("design:type",_t.Color4)],e.prototype,"backgroundColor",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"isHorizontal",void 0),xe([N.field,Te("design:type",Boolean)],e.prototype,"isVertical",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingTop",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingRight",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingBottom",void 0),xe([N.field,Te("design:type",Number)],e.prototype,"paddingLeft",void 0),xe([Zt.uuidEvent,Te("design:type",Object)],e.prototype,"onChanged",void 0),e=xe([z("engine.shape",Pt.UI_SLIDER_SHAPE)],e)}(Re);var Ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ee=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s},Se=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useDummyModel=!1,e.talking=!1,e}var n;return Ae(e,t),n=e,e.Dummy=function(){var t=new n;return t.useDummyModel=!0,t},Ee([N.field,Se("design:type",String)],e.prototype,"id",void 0),Ee([N.field,Se("design:type",String)],e.prototype,"name",void 0),Ee([N.field,Se("design:type",String)],e.prototype,"expressionTriggerId",void 0),Ee([N.field,Se("design:type",Number)],e.prototype,"expressionTriggerTimestamp",void 0),Ee([N.field,Se("design:type",String)],e.prototype,"bodyShape",void 0),Ee([N.field,Se("design:type",Array)],e.prototype,"wearables",void 0),Ee([N.field,Se("design:type",Object)],e.prototype,"skinColor",void 0),Ee([N.field,Se("design:type",Object)],e.prototype,"hairColor",void 0),Ee([N.field,Se("design:type",Object)],e.prototype,"eyeColor",void 0),Ee([N.field,Se("design:type",Boolean)],e.prototype,"useDummyModel",void 0),Ee([N.field,Se("design:type",Boolean)],e.prototype,"talking",void 0),e=n=Ee([C("engine.avatarShape",Pt.AVATAR_SHAPE)],e)}(N),Ce=null,ze=null,Pe=null;function Me(){return Pe||(Pe=new X),Pe}!function(){function t(){var t=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!ze){(ze=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(t){Ce=t}));var t=Me();dcl.subscribe("comms"),dcl.onEvent((function(e){"comms"===e.type&&t.notifyObservers(e.data)}))}return ze}().then((function(){t.connected=!0,t.flush()}))}t.prototype.on=function(t,e){return Me().add((function(n){try{var i=JSON.parse(n.message);i.message===t&&e(i.payload,n.sender)}catch(n){dcl.error("Error parsing comms message "+(n.message||""),n)}}))},t.prototype.sendRaw=function(t){this.messageQueue.push(t),this.connected&&this.flush()},t.prototype.emit=function(t,e){var n=JSON.stringify({message:t,payload:e});this.sendRaw(n),Me().notifyObservers({message:n,sender:"self"})},t.prototype.flush=function(){var t=this;if(0!==this.messageQueue.length&&this.connected&&Ce&&!this.flushing){var e=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(Ce.rpcHandle,"send",[e]).then((function(e){t.flushing=!1,t.flush()}),(function(e){t.flushing=!1,a("Error flushing MessageBus",e)}))}}}();var Ie=new D("scene");Ie.uuid="0";var Ne=new H(Ie);z.engine=Ne,"undefined"!=typeof dcl&&(Ne.addSystem(new vt(dcl),1/0),function(t){(Q=t)&&Q.onEvent((function(t){switch(t.type){case"onEnterScene":return void ot.notifyObservers(t.data);case"onLeaveScene":return void rt.notifyObservers(t.data);case"cameraModeChanged":return void nt.notifyObservers(t.data);case"idleStateChanged":return void it.notifyObservers(t.data);case"sceneStart":return void st.notifyObservers(t.data);case"playerExpression":return void at.notifyObservers(t.data);case"videoEvent":var e=t.data,n=z.engine.disposableComponents[e.componentId];return n&&n.update(e),void lt.notifyObservers(e);case"profileChanged":return void pt.notifyObservers(t.data);case"onPointerLock":return void ct.notifyObservers(t.data);case"playerConnected":return void ut.notifyObservers(t.data);case"playerDisconnected":return void ht.notifyObservers(t.data);case"onRealmChanged":return void dt.notifyObservers(t.data);case"playerClicked":return void yt.notifyObservers(t.data)}}))}(dcl)),Ne.addSystem(ce),Ne.addSystem(ae),Ne.addSystem(se);const Fe=new X,Le=new Map;class De extends D{constructor(t,e=new Oe){super(),this.userId=t,this.visible=!0,this.avatarShape=e,this.avatarShape.useDummyModel=!0,this.addComponentOrReplace(this.avatarShape),this.eventManager=new h,this.eventManager.fireEvent,this.transform=this.getComponentOrCreate(kt)}loadProfile(t){if(t&&t.name&&t.avatar.bodyShape){const{avatar:e}=t,n=this.avatarShape;n.id=this.userId,n.name=t.name,this.avatarShape.useDummyModel=!1,n.bodyShape=e.bodyShape,n.wearables=e.wearables,n.skinColor=e.skinColor,n.hairColor=e.hairColor,n.eyeColor=e.eyeColor,n.expressionTriggerId||(n.expressionTriggerId="Idle",n.expressionTriggerTimestamp=0)}else this.avatarShape.useDummyModel=!0;this.updateVisibility()}setVisible(t){this.visible!==t&&(this.visible=t),this.updateVisibility()}setTalking(t){this.avatarShape.talking=t}setUserData(t){t.position&&this.setPose(t.position),t.expression&&this.setExpression(t.expression.expressionType,t.expression.expressionTimestamp)}setExpression(t,e){const n=this.avatarShape;n.expressionTriggerId=t,n.expressionTriggerTimestamp=e}setPose(t){const[e,n,i,o,r,s,a,c]=t,l=c&&this.visible;l&&this.remove(),this.transform.position.set(e,n,i),this.transform.rotation.set(o,r,s,a),l&&Ne.addEntity(this)}remove(){this.isAddedToEngine()&&Ne.removeEntity(this)}updateVisibility(){!this.visible&&this.isAddedToEngine()?this.remove():this.visible&&!this.isAddedToEngine()&&Ne.addEntity(this)}}function je(t){let e=Le.get(t);return e||(e=new De(t),Le.set(t,e),e)}Fe.add(t=>{"USER_DATA"===t.type?function({userId:t,data:e,profile:n}){var i;const o=je(t);o.setUserData(e),o.loadProfile(n),o.setVisible(null===(i=e.visible)||void 0===i||i)}(t):"USER_VISIBLE"===t.type?function({userId:t,visible:e}){je(t).setVisible(e)}(t):"USER_EXPRESSION"===t.type?function({userId:t,expressionId:e,timestamp:n}){je(t).setExpression(e,n)}(t):"USER_REMOVED"===t.type?function({userId:t}){const e=Le.get(t);e&&(e.remove(),Le.delete(t))}(t):"USER_TALKING"===t.type&&function({userId:t,talking:e}){je(t).setTalking(e)}(t)}),U(async()=>{const[t,e]=await Promise.all([dcl.loadModule("@decentraland/Identity",{}),dcl.loadModule("@decentraland/SocialController",{})]);dcl.onUpdate(async t=>{const n=await dcl.callRpc(e.rpcHandle,"pullAvatarEvents",[]);for(const{payload:t}of n.events)try{Fe.notifyObservers(JSON.parse(t))}catch(t){console.error(t)}})})}])}));